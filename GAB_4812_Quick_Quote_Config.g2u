Program.Sub.ScreenSU.Start
Gui.frmQte..Create
Gui.frmQte..Caption("Quick Quote/Sales Order Configurator")
Gui.frmQte..Size(13890,8250)
Gui.frmQte..MinX(13890)
Gui.frmQte..MinY(8250)
Gui.frmQte..Position(0,0)
Gui.frmQte..BackColor(-2147483633)
Gui.frmQte..MousePointer(0)
Gui.frmQte..Event(UnLoad,frmQte_UnLoad)
Gui.frmQte.frameSel.Create(Frame)
Gui.frmQte.frameSel.Size(1350,750)
Gui.frmQte.frameSel.Position(1215,-30)
Gui.frmQte.optOrd.Create(Option)
Gui.frmQte.optOrd.Size(1245,255)
Gui.frmQte.optOrd.Position(60,435)
Gui.frmQte.optOrd.Parent("frameSel")
Gui.frmQte.optOrd.Caption("Sales Order")
Gui.frmQte.optOrd.TabStop(True)
Gui.frmQte.optOrd.TabIndex(4)
Gui.frmQte.optOrd.Event(Click,OptQteSO)
Gui.frmQte.optQte.Create(Option)
Gui.frmQte.optQte.Size(1245,255)
Gui.frmQte.optQte.Position(60,135)
Gui.frmQte.optQte.Parent("frameSel")
Gui.frmQte.optQte.Caption("Quote")
Gui.frmQte.optQte.TabStop(True)
Gui.frmQte.optQte.TabIndex(3)
Gui.frmQte.optQte.Event(Click,OptQteSO)
Gui.frmQte.frameInfo.Create(Frame)
Gui.frmQte.frameInfo.Size(9375,1740)
Gui.frmQte.frameInfo.Position(60,1020)
Gui.frmQte.txtQty.Create(TextBox,"",True,1215,300,0,5385,735,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtQty.Parent("frameInfo")
Gui.frmQte.txtQty.TabStop(True)
Gui.frmQte.txtQty.TabIndex(14)
Gui.frmQte.lblCust.Create(Label,"Customer",True,1260,255,0,75,525,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblCust.Parent("frameInfo")
Gui.frmQte.lblCust.DefaultValue("Customer")
Gui.frmQte.cmdCust.Create(Button)
Gui.frmQte.cmdCust.Size(345,345)
Gui.frmQte.cmdCust.Position(1665,720)
Gui.frmQte.cmdCust.Parent("frameInfo")
Gui.frmQte.cmdCust.Caption("^")
Gui.frmQte.cmdCust.Event(Click,cmdCust_Click)
Gui.frmQte.cmdCust.TabStop(True)
Gui.frmQte.cmdCust.TabIndex(10)
Gui.frmQte.lblPart.Create(Label,"Part Number",True,1560,255,0,2505,525,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblPart.Parent("frameInfo")
Gui.frmQte.cmdPart.Create(Button)
Gui.frmQte.cmdPart.Size(345,345)
Gui.frmQte.cmdPart.Position(4995,705)
Gui.frmQte.cmdPart.Parent("frameInfo")
Gui.frmQte.cmdPart.Caption("^")
Gui.frmQte.cmdPart.Event(Click,cmdPart_Click)
Gui.frmQte.cmdPart.TabStop(True)
Gui.frmQte.cmdPart.TabIndex(13)
Gui.frmQte.lblPartDesc.Create(Label,"Part Description",True,2385,255,0,2505,1140,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblPartDesc.Parent("frameInfo")
Gui.frmQte.lblQty.Create(Label,"Quantity",True,1215,255,0,5385,525,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblQty.Parent("frameInfo")
Gui.frmQte.cmdSave.Create(Button)
Gui.frmQte.cmdSave.Size(735,375)
Gui.frmQte.cmdSave.Position(8580,1260)
Gui.frmQte.cmdSave.Parent("frameInfo")
Gui.frmQte.cmdSave.Caption("Save")
Gui.frmQte.cmdSave.Event(Click,cmdSave_Click)
Gui.frmQte.cmdSave.TabStop(True)
Gui.frmQte.cmdSave.TabIndex(22)
Gui.frmQte.lblCustName.Create(Label,"Customer Name",True,2385,255,0,75,1140,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblCustName.Parent("frameInfo")
Gui.frmQte.txtPartDesc.Create(TextBox,"",True,2385,300,0,2505,1350,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtPartDesc.Parent("frameInfo")
Gui.frmQte.txtPartDesc.TabStop(True)
Gui.frmQte.txtPartDesc.TabIndex(17)
Gui.frmQte.txtPartDesc.Locked(True)
Gui.frmQte.lblLoc.Create(Label,"Loc",True,405,255,0,4455,525,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblLoc.Parent("frameInfo")
Gui.frmQte.txtLine.Create(TextBox,"",True,420,300,0,510,135,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtLine.Parent("frameInfo")
Gui.frmQte.txtLine.MaxLength(3)
Gui.frmQte.txtLine.TabStop(True)
Gui.frmQte.txtLine.TabIndex(7)
Gui.frmQte.lblLine.Create(Label,"Line",True,420,255,0,75,180,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblLine.Parent("frameInfo")
Gui.frmQte.lblLine.DefaultValue("Line")
Gui.frmQte.txtLineSuf.Create(TextBox,"",False,285,300,0,975,135,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtLineSuf.Parent("frameInfo")
Gui.frmQte.txtLineSuf.MaxLength(3)
Gui.frmQte.txtLineSuf.TabStop(True)
Gui.frmQte.txtLineSuf.TabIndex(8)
Gui.frmQte.optTopLevel.Create(Option)
Gui.frmQte.optTopLevel.Size(2010,255)
Gui.frmQte.optTopLevel.Position(6525,1095)
Gui.frmQte.optTopLevel.Parent("frameInfo")
Gui.frmQte.optTopLevel.Caption("Top Level Pricing (B)")
Gui.frmQte.optTopLevel.TabStop(True)
Gui.frmQte.optTopLevel.TabIndex(19)
Gui.frmQte.optComponent.Create(Option)
Gui.frmQte.optComponent.Size(2025,255)
Gui.frmQte.optComponent.Position(6525,1380)
Gui.frmQte.optComponent.Parent("frameInfo")
Gui.frmQte.optComponent.Caption("Component Pricing (C)")
Gui.frmQte.optComponent.TabStop(True)
Gui.frmQte.optComponent.TabIndex(20)
Gui.frmQte.lblDueDate.Create(Label,"Due Date",True,780,255,0,4980,1140,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblDueDate.Parent("frameInfo")
Gui.frmQte.dtpDueDate.Create(DatePicker)
Gui.frmQte.dtpDueDate.Size(1425,285)
Gui.frmQte.dtpDueDate.Position(4980,1350)
Gui.frmQte.dtpDueDate.Parent("frameInfo")
Gui.frmQte.dtpDueDate.TabStop(True)
Gui.frmQte.dtpDueDate.TabIndex(18)
Gui.frmQte.txtQtyOnHand.Create(TextBox,"",False,300,300,0,8070,150,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtQtyOnHand.Parent("frameInfo")
Gui.frmQte.txtQtyOnHand.Locked(True)
Gui.frmQte.txtQtyReq.Create(TextBox,"",False,300,300,0,8385,150,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtQtyReq.Parent("frameInfo")
Gui.frmQte.txtQtyReq.Locked(True)
Gui.frmQte.txtProdLine.Create(TextBox,"",False,300,300,0,8700,150,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtProdLine.Parent("frameInfo")
Gui.frmQte.txtProdLine.Locked(True)
Gui.frmQte.txtRouter.Create(TextBox,"",False,300,300,0,9015,150,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtRouter.Parent("frameInfo")
Gui.frmQte.txtRouter.Locked(True)
Gui.frmQte.cmdClear.Create(Button)
Gui.frmQte.cmdClear.Size(735,375)
Gui.frmQte.cmdClear.Position(8580,855)
Gui.frmQte.cmdClear.Parent("frameInfo")
Gui.frmQte.cmdClear.TabStop(True)
Gui.frmQte.cmdClear.TabIndex(21)
Gui.frmQte.cmdClear.Caption("Clear")
Gui.frmQte.cmdClear.Event(Click,Clear)
Gui.frmQte.txtCustPO.Create(TextBox,"",False,1890,300,0,6660,735,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtCustPO.Parent("frameInfo")
Gui.frmQte.txtCustPO.TabStop(True)
Gui.frmQte.txtCustPO.TabIndex(15)
Gui.frmQte.lblCustPO.Create(Label,"Customer PO",False,1260,255,0,6660,525,True,0,"Arial",8,-2147483633,0)
Gui.frmQte.lblCustPO.Parent("frameInfo")
Gui.frmQte.cboCust.Create(ComboBox)
Gui.frmQte.cboCust.Size(1560,330)
Gui.frmQte.cboCust.Position(75,735)
Gui.frmQte.cboCust.Parent("frameInfo")
Gui.frmQte.cboCust.TabStop(True)
Gui.frmQte.cboCust.TabIndex(9)
Gui.frmQte.cboCust.Event(LostFocus,cboCust_LostFocus)
Gui.frmQte.cboCustName.Create(ComboBox)
Gui.frmQte.cboCustName.Size(2385,330)
Gui.frmQte.cboCustName.Position(75,1350)
Gui.frmQte.cboCustName.Parent("frameInfo")
Gui.frmQte.cboCustName.TabStop(True)
Gui.frmQte.cboCustName.TabIndex(16)
Gui.frmQte.cboCustName.Event(LostFocus,cboCustName_LostFocus)
Gui.frmQte.cboPart.Create(ComboBox)
Gui.frmQte.cboPart.Size(1905,330)
Gui.frmQte.cboPart.Position(2505,735)
Gui.frmQte.cboPart.Parent("frameInfo")
Gui.frmQte.cboPart.TabStop(True)
Gui.frmQte.cboPart.TabIndex(11)
Gui.frmQte.cboPart.Event(LostFocus,cboPart_LostFocus)
Gui.frmQte.cboLoc.Create(ComboBox)
Gui.frmQte.cboLoc.Size(525,330)
Gui.frmQte.cboLoc.Position(4455,735)
Gui.frmQte.cboLoc.Parent("frameInfo")
Gui.frmQte.cboLoc.TabStop(True)
Gui.frmQte.cboLoc.TabIndex(12)
Gui.frmQte.cboLoc.Event(LostFocus,cboLoc_LostFocus)
Gui.frmQte.txtUM.Create(TextBox,"",False,300,300,0,7755,150,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtUM.Parent("frameInfo")
Gui.frmQte.txtUM.Locked(True)
Gui.frmQte.frameLines.Create(Frame)
Gui.frmQte.frameLines.Size(13665,4770)
Gui.frmQte.frameLines.Position(60,2775)
Gui.frmQte.frameLines.Anchor(15)
Gui.frmQte.GsGCLines.Create(GsGridControl)
Gui.frmQte.GsGCLines.Size(13620,4605)
Gui.frmQte.GsGCLines.Position(30,120)
Gui.frmQte.GsGCLines.Parent("frameLines")
Gui.frmQte.GsGCLines.Event(RowCellClick,GsGCLines_RowCellClick)
Gui.frmQte.GsGCLines.Anchor(15)
Gui.frmQte.GsGCLines.TabStop(True)
Gui.frmQte.GsGCLines.TabIndex(24)
Gui.frmQte.GsGCLines.Event(CellValueChanged,GsGCLines_CellValueChanged)
Gui.frmQte.cmdProcess.Create(Button)
Gui.frmQte.cmdProcess.Size(855,375)
Gui.frmQte.cmdProcess.Position(12870,7560)
Gui.frmQte.cmdProcess.Caption("Process")
Gui.frmQte.cmdProcess.Event(Click,cmdProcess_Click)
Gui.frmQte.cmdProcess.TabStop(True)
Gui.frmQte.cmdProcess.TabIndex(25)
Gui.frmQte.cmdProcess.Anchor(10)
Gui.frmQte.picGSSLogo.Create(PictureBox)
Gui.frmQte.picGSSLogo.Size(4125,960)
Gui.frmQte.picGSSLogo.Position(4740,45)
Gui.frmQte.picGSSLogo.Anchor(1)
Gui.frmQte.lblStatus.Create(Label,"***Change***",False,11865,255,0,60,7665,True,0,"Arial",10,-2147483633,0)
Gui.frmQte.lblStatus.Anchor(6)
Gui.frmQte.frameType.Create(Frame)
Gui.frmQte.frameType.Size(1095,750)
Gui.frmQte.frameType.Position(60,-30)
Gui.frmQte.optNew.Create(Option)
Gui.frmQte.optNew.Size(1020,255)
Gui.frmQte.optNew.Position(60,135)
Gui.frmQte.optNew.Parent("frameType")
Gui.frmQte.optNew.TabStop(True)
Gui.frmQte.optNew.TabIndex(1)
Gui.frmQte.optNew.Caption("New")
Gui.frmQte.optNew.Event(Click,OptNewAdd)
Gui.frmQte.optExisting.Create(Option)
Gui.frmQte.optExisting.Size(1020,255)
Gui.frmQte.optExisting.Position(60,435)
Gui.frmQte.optExisting.Parent("frameType")
Gui.frmQte.optExisting.TabStop(True)
Gui.frmQte.optExisting.TabIndex(2)
Gui.frmQte.optExisting.Caption("Existing")
Gui.frmQte.optExisting.Event(Click,OptNewAdd)
Gui.frmQte.txtQuote.Create(TextBox,"",False,1215,300,0,60,750,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.txtQuote.MaxLength(7)
Gui.frmQte.txtQuote.Locked(True)
Gui.frmQte.txtQuote.TabStop(True)
Gui.frmQte.txtQuote.TabIndex(5)
Gui.frmQte.cmdQteBrw.Create(Button)
Gui.frmQte.cmdQteBrw.Size(375,375)
Gui.frmQte.cmdQteBrw.Position(1305,720)
Gui.frmQte.cmdQteBrw.Caption("^")
Gui.frmQte.cmdQteBrw.Visible(False)
Gui.frmQte.cmdQteBrw.Event(Click,cmdQteBrw_Click)
Gui.frmQte.cmdQteBrw.TabStop(True)
Gui.frmQte.cmdQteBrw.TabIndex(6)
Gui.frmQte.txtLastLine.Create(TextBox,"",False,1215,300,0,1755,750,True,0,"Arial",8,-2147483643,1)
Gui.frmQte.chkAutoWO.Create(CheckBox)
Gui.frmQte.chkAutoWO.Enabled(False)
Gui.frmQte.chkAutoWO.Size(1665,255)
Gui.frmQte.chkAutoWO.Position(9480,1125)
Gui.frmQte.chkAutoWO.Caption("Auto Create WOs")
Gui.frmQte.chkAutoWO.TabStop(True)
Gui.frmQte.chkAutoWO.TabIndex(23)
Gui.frmQte.chkAutoWO.Visible(False)
Gui.frmQte.cmdComments.Create(Button)
Gui.frmQte.cmdComments.Size(1515,375)
Gui.frmQte.cmdComments.Position(9480,2385)
Gui.frmQte.cmdComments.Caption("Group Comments")
Gui.frmQte.cmdComments.Event(Click,cmdComments_Click)
Gui.frmOpts..Create
Gui.frmOpts..Caption("Selections")
Gui.frmOpts..Size(9090,6495)
Gui.frmOpts..MinX(9090)
Gui.frmOpts..MinY(6495)
Gui.frmOpts..Position(0,0)
Gui.frmOpts..BackColor(-2147483633)
Gui.frmOpts..MousePointer(0)
Gui.frmOpts..Event(UnLoad,frmOpts_UnLoad)
Gui.frmOpts.tabSelections.Create(Tab)
Gui.frmOpts.tabSelections.Size(8985,6195)
Gui.frmOpts.tabSelections.Position(0,0)
Gui.frmOpts.tabSelections.Anchor(15)
Gui.frmOpts.tabSelections.Tabs(2)
Gui.frmOpts.tabSelections.SetTab(0)
Gui.frmOpts.tabSelections.Caption("Inventory Search")
Gui.frmOpts.tabSelections.SetTab(1)
Gui.frmOpts.tabSelections.Caption("Options")
Gui.frmOpts.GsGCOpts.Create(GsGridControl)
Gui.frmOpts.GsGCOpts.Size(7425,5775)
Gui.frmOpts.GsGCOpts.Position(0,0)
Gui.frmOpts.GsGCOpts.Event(RowCellClick,GsGCOpts_RowCellClick)
Gui.frmOpts.GsGCOpts.Parent("tabSelections",1)
Gui.frmOpts.GsGCInv.Create(GsGridControl)
Gui.frmOpts.GsGCInv.Size(8865,5775)
Gui.frmOpts.GsGCInv.Position(0,0)
Gui.frmOpts.GsGCInv.Parent("tabSelections",0)
Gui.frmOpts.GsGCInv.Event(RowCellClick,GsGCOpts_RowCellClick)
Gui.frmQty..Create
Gui.frmQty..Caption("")
Gui.frmQty..Size(2355,1410)
Gui.frmQty..MinX(0)
Gui.frmQty..MinY(0)
Gui.frmQty..Position(0,0)
Gui.frmQty..BackColor(-2147483633)
Gui.frmQty..MousePointer(0)
Gui.frmQty..MaxButton(False)
Gui.frmQty..MinButton(False)
Gui.frmQty..Moveable(False)
Gui.frmQty..Sizeable(False)
Gui.frmQty.cmdOK.Create(Button)
Gui.frmQty.cmdOK.Size(855,375)
Gui.frmQty.cmdOK.Position(690,660)
Gui.frmQty.cmdOK.Caption("OK")
Gui.frmQty.cmdOK.Event(Click,cmdOK_Click)
Gui.frmQty.txtQty.Create(TextBox,"",True,1560,300,0,345,315,True,2,"Arial",8,-2147483643,1)
Gui.frmQty.txtQty.Event(KeyPressEnter,cmdOK_Click)
Gui.frmQty.lblMsg.Create(Label,"Enter in Quantity to Make 1",True,2070,255,0,90,105,True,0,"Arial",8,-2147483633,0)
Gui.frmComments..Create
Gui.frmComments..Caption("Group Comments")
Gui.frmComments..Size(10335,6810)
Gui.frmComments..MinX(0)
Gui.frmComments..MinY(0)
Gui.frmComments..Position(0,0)
Gui.frmComments..BackColor(-2147483633)
Gui.frmComments..MousePointer(0)
Gui.frmComments..Event(UnLoad,frmComments_UnLoad)
Gui.frmComments..Event(Resize,frmComments_Resize)
Gui.frmComments.GsGCComments.Create(GsGridControl)
Gui.frmComments.GsGCComments.Size(10170,2550)
Gui.frmComments.GsGCComments.Position(15,15)
Gui.frmComments.GsGCComments.Event(RowCellClick,GsGCComments_RowCellClick)
Gui.frmComments.GsGCComments.TabStop(True)
Gui.frmComments.GsGCComments.TabIndex(1)
Gui.frmComments.cmdNew.Create(Button)
Gui.frmComments.cmdNew.Size(1305,375)
Gui.frmComments.cmdNew.Position(15,2595)
Gui.frmComments.cmdNew.Caption("New Comment")
Gui.frmComments.cmdNew.Event(Click,cmdNew_Click)
Gui.frmComments.cmdNew.TabStop(True)
Gui.frmComments.cmdNew.TabIndex(2)
Gui.frmComments.lblGroup.Create(Label,"Group",True,555,255,0,1350,2715,True,0,"Arial",8,-2147483633,0)
Gui.frmComments.txtGroup.Create(TextBox,"",True,465,300,0,1920,2625,True,2,"Arial",8,-2147483643,1)
Gui.frmComments.txtGroup.Locked(True)
Gui.frmComments.txtGroup.TabStop(True)
Gui.frmComments.txtGroup.TabIndex(3)
Gui.frmComments.txtComments.Create(TextboxM)
Gui.frmComments.txtComments.Size(10170,3390)
Gui.frmComments.txtComments.Position(15,3000)
Gui.frmComments.txtComments.TabStop(True)
Gui.frmComments.txtComments.TabIndex(4)
Gui.frmComments.cmdSave.Create(Button)
Gui.frmComments.cmdSave.Size(660,375)
Gui.frmComments.cmdSave.Position(9525,2595)
Gui.frmComments.cmdSave.Caption("Save")
Gui.frmComments.cmdSave.Event(Click,cmdSave_ClickCmnts)
Gui.frmComments.cmdSave.TabStop(True)
Gui.frmComments.cmdSave.TabIndex(5)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
	V.Global.iRow.Declare
	V.Global.iRowOpt.Declare
	V.Global.iBomSeq.Declare
	F.Global.General.ReadOption(401096,3,0,V.Global.iBomSeq)
	V.Global.bAddComp.Declare
	V.Global.iRowAddComp.Declare
	V.Global.bGroup.Declare
	V.Global.sValues.Declare
	V.Global.iRanKey.Declare
	V.Global.iRowIndex.Declare
	V.Global.sQuoteNo.Declare
Program.Sub.Preflight.End

Program.Sub.Main.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sIcon.Declare
	V.Local.sGssLogo.Declare

	F.Intrinsic.String.Build("{0}\GSS2.ico",V.Caller.GasDir,v.Local.sIcon)
	F.Intrinsic.String.Build("{0}\GAB_GSS_Logo_Green_Dash.png",V.Caller.GasDir,V.Local.sGssLogo)
	Gui.frmQty..Icon(V.Local.sIcon)
	Gui.frmQte..Icon(V.Local.sIcon)
	Gui.frmOpts..Icon(V.Local.sIcon)
	Gui.frmComments..Icon(V.Local.sIcon)
	Gui.frmQte.picGSSLogo.Picture(V.Local.sGssLogo)
	
	F.ODBC.Connection!con.OpenCompanyConnection(500)
	F.Intrinsic.Control.CallSub(CheckTables)
	
	V.Global.iRow.Set(-1)
	Gui.frmQte.optNew.Value(True)
	Gui.frmQte.optQte.Value(True)
	Gui.frmQte.optTopLevel.Value(True)
	Gui.frmQte.txtLine.Text("001")
	Gui.frmQte.txtLineSuf.Text("0")
	Gui.frmQte.txtQty.Text("0.00")
	Gui.frmQte.txtQtyOnHand.Text("0.00")
	Gui.frmQte.txtQtyReq.Text("0.00")
	Gui.frmQte..Show
	F.Intrinsic.Control.CallSub(SetContextMenus)
	F.Intrinsic.Control.CallSub(LoadComboboxes)
	F.Intrinsic.Control.CallSub(GenerateKey)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.GenerateKey.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.fRnd.Declare
	V.Local.sSQL.Declare
	V.Local.sRet.Declare
	V.Local.sQte.Declare

	F.Intrinsic.Math.Rnd(,V.Local.fRnd)
	F.Intrinsic.Math.Rnd(V.Local.fRnd)
	F.Intrinsic.Math.Mult(V.Local.fRnd,100000,V.Local.fRnd)
	F.Intrinsic.Math.IDiv(V.Local.fRnd,1,V.Global.iRanKey)
	
	V.Local.sQte.Set(V.Screen.frmQte!txtQuote.Text)
	
	F.Intrinsic.Control.If(V.Screen.frmQte!optNew.Value)
		F.Intrinsic.Control.DoUntil(V.Ambient.ExecuteAndReturnEOF)
			F.Intrinsic.String.Build("Select RanKey From GAB_4812_BOM_CFGSUBS Where RanKey = {0} Union Select RanKey From GAB_4812_BOM_CMNTS Where RanKey = {0};",V.Global.iRanKey,V.Local.sSQL)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Local.sRet)
		F.Intrinsic.Control.Loop
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
			F.Intrinsic.String.Build("Select Distinct RanKey From GAB_4812_BOM_CFGSUBS Where Quote_No = '{0}';",V.Local.sQte,V.Local.sSQL)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Select Distinct RanKey From GAB_4812_BOM_CFGSUBS Where Order_No = '{0}';",V.Local.sQte,V.Local.sSQL)
		F.Intrinsic.Control.EndIf
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSQL,V.Global.iRanKey)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GenerateKey.End

Program.Sub.frmQte_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End 
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmQte_UnLoad.End

Program.Sub.CheckTables.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	v.Local.bTable.Declare
	
	F.ODBC.Connection!con.TableExists("GAB_4812_BOM_CONFIG",V.Local.bTable)
	F.Intrinsic.Control.If(v.Local.bTable,=,False)
		F.ODBC.Connection!Con.Execute("CREATE TABLE GAB_4812_BOM_CONFIG(CID IDENTITY,PARENT CHAR(20),COMPONENT CHAR(20),OPTIONS CHAR(20),PRIMARY KEY (CID));")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.TableExists("GAB_4812_BOM_CFGSUBS",V.Local.bTable)
	F.Intrinsic.Control.If(v.Local.bTable,=,False)
		F.ODBC.Connection!Con.Execute("CREATE TABLE GAB_4812_BOM_CFGSUBS(CSID IDENTITY,GRPID INTEGER,RANKEY INTEGER,ORDLN INTEGER,PARENT_LINE INTEGER,PARENT CHAR(20),PART_ORIG CHAR(20),PART_SUB CHAR(20),QUOTE_NO CHAR(7),ORDER_NO CHAR(7),BOM_SEQ CHAR(4),QTY NUMERIC(12,4),QTY_6 NUMERIC(14,6),UM CHAR(2),PRIMARY KEY(CSID));")
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.TableExists("GAB_4812_BOM_CMNTS",V.Local.bTable)
	F.Intrinsic.Control.If(v.Local.bTable,=,False)
		F.ODBC.Connection!Con.Execute("CREATE TABLE GAB_4812_BOM_CMNTS(CMID IDENTITY,GRPID INTEGER,RANKEY INTEGER,COMMENTS LONGVARCHAR,PRIMARY KEY(CMID));")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckTables.End

Program.Sub.LoadComboboxes.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmQte.lblStatus.Caption("Loading Type Ahead....")
	Gui.frmQte.lblStatus.Visible(True)
	
	'Customer
	F.Data.DataTable.CreateFromSQL("dtCust","con","Select Customer,Name_Customer From V_Customer_Master Order By Customer,Name_Customer;",True)
	F.Data.Dictionary.CreateFromDataTable("dicCust","dtCust","Customer","Customer",2)
	Gui.frmQte.cboCust.AddItems("Dictionary","dicCust")
	F.Data.Dictionary.CreateFromDataTable("dicCustName","dtCust","Name_Customer","Name_Customer",2)
	Gui.frmQte.cboCustName.AddItems("Dictionary","dicCustName")
	
	'Part Number
	F.Data.DataTable.CreateFromSQL("dtPart","con","Select Part,Location,Description,Code_Bom,Time_Material_Lead,Qty_OnHand,Qty_Required,Product_Line,UM_Inventory As UM From V_Inventory_Mstr Order By Part,Location;",True)
	F.Data.Dictionary.CreateFromDataTable("dicPart","dtPart","Part","Part",2)
	Gui.frmQte.cboPart.AddItems("Dictionary","dicPart")
	F.Data.Dictionary.CreateFromDataTable("dicLoc","dtPart","Location","Location",2)
	Gui.frmQte.cboLoc.AddItems("Dictionary","dicLoc")
	
	'Get Values
	F.ODBC.Connection!con.ExecuteAndReturn("Select Part From V_Inventory_Mstr Order By Part,Location;",V.Global.sValues)
	F.Intrinsic.String.Replace(V.Global.sValues,"#$#","*!*",V.Global.sValues)
	
	Gui.frmQte.lblStatus.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadComboboxes.End

Program.Sub.Clear.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iLine.Declare
	
	Gui.frmQte.txtLineSuf.Text("0")
	Gui.frmQte.cboPart.Text("")
	Gui.frmQte.cboLoc.Text("")
	Gui.frmQte.txtPartDesc.Text("")
	Gui.frmQte.txtQty.Text("0.00")
	Gui.frmQte.txtQtyOnHand.Text("0.00")
	Gui.frmQte.txtQtyReq.Text("0.00")
	Gui.frmQte.dtpDueDate.Text(V.Ambient.Date)
	Gui.frmQte.optTopLevel.Value(True)
	Gui.frmQte.txtLine.Text("001")
	Gui.frmQte.txtUM.Text("")
	F.Intrinsic.Control.If(V.DataTable.dtLines.Exists)
		F.Data.DataTable.Compute("dtLines","Max(Line)","",V.Local.iLine)
		F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
		Gui.frmQte.txtLine.Text(V.Local.iLine.Format000)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.iLine,=,1)
		Gui.frmQte.txtCustPO.Locked(False)
		Gui.frmQte.frameType.Enabled(True)
		Gui.frmQte.frameSel.Enabled(True)
	F.Intrinsic.Control.EndIf
	
	V.Global.iRow.Set(-1)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Clear.End

Program.Sub.SetContextMenus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmQte..ContextMenuCreate("ctxLines")
	Gui.frmQte.GsGCLines.ContextMenuAttach("ctxLines")
	Gui.frmQte..ContextMenuAddItem("ctxLines","Copy",0,"Copy Line")
	Gui.frmQte..ContextMenuAddItem("ctxLines","Delete",0,"Delete Line")
	Gui.frmQte..ContextMenuAddItem("ctxLines","Add",0,"Add Component")
	Gui.frmQte..ContextMenuAddItem("ctxLines","Remove",0,"Remove Component")
	Gui.frmQte..ContextMenuSetItemEventHandler("ctxLines","Copy","MenuClick")
	Gui.frmQte..ContextMenuSetItemEventHandler("ctxLines","Delete","MenuClick")
	Gui.frmQte..ContextMenuSetItemEventHandler("ctxLines","Add","MenuClick")
	Gui.frmQte..ContextMenuSetItemEventHandler("ctxLines","Remove","MenuClick")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetContextMenus.End

Program.Sub.MenuClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRow.Declare
	V.Local.iLine.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.iParentLine.Declare
	V.Local.sParent.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.ItemName)
		F.Intrinsic.Control.Case("COPY")
			Gui.frmQte.GsGCLines.GetSelectedRows("gvLines",V.Local.iRow)
			F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iRow).ParentFlag!FieldValTrim,=,"N",OR,V.DataTable.dtLines(V.Local.iRow).ParentFlag!FieldValTrim,=,"Y")
				Gui.frmQte.txtLineSuf.Text(V.DataTable.dtLines(V.Local.iRow).LineSuf!FieldVal)
				Gui.frmQte.cboPart.Text(V.DataTable.dtLines(V.Local.iRow).Part!FieldValTrim)
				Gui.frmQte.cboLoc.Text(V.DataTable.dtLines(V.Local.iRow).Location!FieldValTrim)
				Gui.frmQte.txtPartDesc.Text(V.DataTable.dtLines(V.Local.iRow).Description!FieldValTrim)
				Gui.frmQte.txtQty.Text(V.DataTable.dtLines(V.Local.iRow).Qty!FieldVal)
				Gui.frmQte.txtQtyOnHand.Text(V.DataTable.dtLines(V.Local.iRow).QtyOnHand!FieldVal)
				Gui.frmQte.txtQtyReq.Text(V.DataTable.dtLines(V.Local.iRow).QtyReq!FieldVal)
				Gui.frmQte.txtProdLine.Text(V.DataTable.dtLines(V.Local.iRow).ProdLine!FieldVal)
				Gui.frmQte.dtpDueDate.Text(V.DataTable.dtLines(V.Local.iRow).DueDate!FieldVal)
				Gui.frmQte.txtUM.Text(V.DataTable.dtLines(V.Local.iRow).UM!FieldVal)
				F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iRow).Pricing!FieldValTrim,=,"B")
					Gui.frmQte.optTopLevel.Value(1)
					Gui.frmQte.optComponent.Value(0)
					Gui.frmQte.optTopLevel.Enabled(True)
					Gui.frmQte.optComponent.Enabled(True)
				F.Intrinsic.Control.ElseIf(V.DataTable.dtLines(V.Local.iRow).Pricing!FieldValTrim,=,"C")
					Gui.frmQte.optTopLevel.Value(0)
					Gui.frmQte.optComponent.Value(1)
					Gui.frmQte.optTopLevel.Enabled(True)
					Gui.frmQte.optComponent.Enabled(True)
				F.Intrinsic.Control.Else
					Gui.frmQte.optTopLevel.Value(0)
					Gui.frmQte.optComponent.Value(0)
					Gui.frmQte.optTopLevel.Enabled(False)
					Gui.frmQte.optComponent.Enabled(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iRow).Router!FieldValTrim)
					Gui.frmQte.txtRouter.Text("Y")
				F.Intrinsic.Control.Else
					Gui.frmQte.txtRouter.Text("N")
				F.Intrinsic.Control.EndIf
				F.Data.DataTable.Compute("dtLines","Max(Line)","",V.Local.iLine)
				F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
				Gui.frmQte.txtLine.Text(V.Local.iLine.Format000)
				V.Global.iRow.Set(-1)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Case("DELETE")
			Gui.frmQte.GsGCLines.GetSelectedRows("gvLines",V.Local.iRow)
			F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iRow).ParentFlag!FieldValTrim,=,"N",OR,V.DataTable.dtLines(V.Local.iRow).ParentFlag!FieldValTrim,=,"Y")
				F.Intrinsic.String.Build("ParentLine = {0}",V.DataTable.dtLines(V.Local.iRow).ParentLine!FieldVal,V.Local.sExp)
				F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
				F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
					F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
					F.Intrinsic.Control.For(V.Local.iCnt,V.Local.sSelect.UBound,0,-1)
						F.Data.DataTable.DeleteRow("dtLines",V.Local.sSelect(V.Local.iCnt).Long)
					F.Intrinsic.Control.Next(V.Local.iCnt)
				F.Intrinsic.Control.EndIf
				F.Data.DataTable.SetSeries("dtLines","Line",1,1)
				'Set Parent Lines
				F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtLines.RowCount--,1)
					F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim)
						F.Intrinsic.Control.CaseAny("N","Y")
							F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
							V.Local.iParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
						F.Intrinsic.Control.CaseElse
							F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.Local.iParentLine)
					F.Intrinsic.Control.EndSelect
				F.Intrinsic.Control.Next(V.Local.iCnt)
				F.Intrinsic.Control.CallSub(LoadGVLines)
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.Compute("dtLines","Max(Line)","",V.Local.iLine)
			F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
			Gui.frmQte.txtLine.Text(V.Local.iLine.Format000)
			F.Intrinsic.Control.If(V.Local.iLine.Format000,=,"001")
			F.Intrinsic.Control.AndIf(V.DataTable.dtLines.RowCount,=,0)
				Gui.frmQte.txtCustPO.Locked(False)
				Gui.frmQte.frameType.Enabled(True)
				Gui.frmQte.frameSel.Enabled(True)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Case("ADD")
			Gui.frmQte.GsGCLines.GetSelectedRows("gvLines",V.Global.iRowAddComp)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentFlag",V.Global.iRowAddComp,V.Local.sParent)
			F.Intrinsic.Control.If(V.Local.sParent,<>,"Y",AND,V.Local.sParent,<>,"N")
				V.Global.bAddComp.Set(True)
				F.Intrinsic.Control.CallSub(AddCompBrw)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Case("REMOVE")
			Gui.frmQte.GsGCLines.GetSelectedRows("gvLines",V.Local.iRow)
			F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iRow).ParentFlag!FieldValTrim,<>,"N",AND,V.DataTable.dtLines(V.Local.iRow).ParentFlag!FieldValTrim,<>,"Y")
				F.Data.DataTable.DeleteRow("dtLines",V.Local.iRow)
				F.Data.DataTable.SetSeries("dtLines","Line",1,1)
				F.Intrinsic.Control.CallSub(LoadGVLines)
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClick.End

Program.Sub.AddCompBrw.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.sSql.Declare
	V.Local.dRet.Declare
	
	V.Local.sMsg.Declare
	V.Local.sComponent.Declare
	V.Local.bRouter.Declare
	V.Local.iLine.Declare
	V.Local.iLineSuf.Declare
	V.Local.sParent.Declare
	V.Local.iParentLine.Declare
	V.Local.iBomSeq.Declare
	V.Local.fQty.Declare
	V.Local.fQtyOnHand.Declare
	V.Local.fQtyReq.Declare
	V.Local.dDueDate.Declare
	V.Local.iQty.Declare
	V.Local.iOrigQty.Declare
	V.Local.iParentQty.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.UI.Browser(105,"",V.Local.sRet)
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","Line",V.Global.iRowAddComp,V.Local.iLine)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","LineSuf",V.Global.iRowAddComp,V.Local.iLineSuf)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentFlag",V.Global.iRowAddComp,V.Local.sParent)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentLine",V.Global.iRowAddComp,V.Local.iParentLine)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","BomSeq",V.Global.iRowAddComp,V.Local.iBomSeq)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","DueDate",V.Global.iRowAddComp,V.Local.dDueDate)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","QtyOrig",V.Global.iRowAddComp,V.Local.iOrigQty)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","Qty",V.Global.iRowAddComp,V.Local.iQty)
		
		V.Local.sComponent.Set(V.Local.sRet(0))
		F.Intrinsic.String.Build("Select Description,Qty_OnHand,Qty_Required,Product_Line From Inventory_Mstr Where Part = '{0}' Order By Location;",V.Local.sComponent,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		F.Intrinsic.Control.CallSub(EnterQty)
		F.Intrinsic.Math.Div(V.Local.iQty,V.Local.iOrigQty,V.Local.iParentQty)
		F.Intrinsic.Math.Mult(V.Local.iParentQty,V.Screen.frmQty!txtQty.Text,V.Local.fQty)
		F.Intrinsic.Control.If(V.Local.sRet(1),=,"OOB")
			V.Local.fQtyOnHand.Set(0)
		F.Intrinsic.Control.Else
			V.Local.fQtyOnHand.Set(V.Local.sRet(1))
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.sRet(2),=,"OOB")
			V.Local.fQtyReq.Set(0)
		F.Intrinsic.Control.Else
			V.Local.fQtyReq.Set(V.Local.sRet(2))
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}';",V.Local.sComponent,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
		F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
			V.Local.bRouter.Set(False)
		F.Intrinsic.Control.Else
			V.Local.bRouter.Set(True)
		F.Intrinsic.Control.EndIf
			
		'BomSeq
		F.Intrinsic.String.Build("ParentLine = {0}",V.Local.iParentLine,V.Local.sExp)
		F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Math.Add(V.DataTable.dtLines(V.Local.sSelect(V.Local.sSelect.UBound)).BomSeq!FieldVal,V.Global.iBomSeq,V.Local.iBomSeq)

		F.Data.DataTable.AddRow("dtLines","Line",V.Local.iLine.Format000,"LineSuf",V.Local.iLineSuf.Format0,"ParentLine",V.Local.iLine.Format000,"Customer",V.Screen.frmQte!cboCust.Text,"CustomerName",V.Screen.frmQte!cboCustName.Text,"CustPO",V.Screen.frmQte!txtCustPO.Text,"ParentFlag",V.Local.sParent.Trim,"BomSeq",V.Local.iBomSeq.Format0000,"Router",V.Local.bRouter,"PartOrig",V.Local.sComponent.Trim,"Part",V.Local.sComponent.Trim,"Location","","Description",V.Local.sRet(0).Trim,"ProdLine",V.Local.sRet(3).Trim,"QtyOrig",V.Screen.frmQty!txtQty.Text,"Qty",V.Local.fQty,"QtyOnHand",V.Local.fQtyOnHand,"QtyReq",V.Local.fQtyReq,"DueDate",V.Local.dDueDate,"Pricing","")

'		F.Data.DataTable.MoveRow("dtLines",V.DataTable.dtLines.RowCount--,V.Global.iRowAddComp.++)
		F.Data.DataTable.MoveRow("dtLines",V.DataTable.dtLines.RowCount--,V.Local.sSelect(V.Local.sSelect.UBound).++)
			
		F.Data.DataTable.SetSeries("dtLines","Line",1,1)
		'Set Parent Lines
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtLines.RowCount--,1)
			F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim)
				F.Intrinsic.Control.CaseAny("N","Y")
					F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
					V.Local.iParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
				F.Intrinsic.Control.CaseElse
					F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.Local.iParentLine)
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Intrinsic.Control.CallSub(LoadGVLines)
	
		V.Global.bAddComp.Set(False)
		F.Data.DataTable.Compute("dtLines","Max(Line)","",V.Local.iLine)
		F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
		Gui.frmQte.txtLine.Text(V.Local.iLine.Format000)
		Gui.frmQty.txtQty.Text("")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.AddCompBrw.End

Program.Sub.cmdCust_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sRet.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtLines.Exists)
		F.Intrinsic.Control.If(V.DataTable.dtLines.RowCount,<>,0)
			F.Intrinsic.UI.Msgbox("You can only select 1 customer per Quote/Sales Order creation.","Quick Quote/Sales Order Configurator")
			F.Intrinsic.Control.ExitSub
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.UI.Browser(205,"",V.Local.sRet)
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.frmQte.cboCust.Text(V.Local.sRet(0))
		Gui.frmQte.cboCustName.Caption(V.Local.sRet(1))
		Gui.frmQte.txtCustPO.Text("")
		Gui.frmQte.txtCustPO.Locked(False)
		Gui.frmQte.frameType.Enabled(True)
		Gui.frmQte.frameSel.Enabled(True)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdCust_Click.End

Program.Sub.cmdPart_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.sSql.Declare
	V.Local.dRet.Declare
	
	Gui.frmOpts.GsGCInv.Anchor(15)
	Gui.frmOpts.GsGCOpts.Anchor(15)
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.UI.Browser(105,"",V.Local.sRet)
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		Gui.frmQte.cboPart.Text(V.Local.sRet(0))
		Gui.frmQte.cboLoc.Text(V.Local.sRet(1))
		Gui.frmQte.txtPartDesc.Caption(V.Local.sRet(2))
		Gui.frmQte.txtQty.Text("1.00")
		F.Intrinsic.String.Build("Select Code_Bom,Time_Material_Lead,Qty_OnHand,Qty_Required,Product_Line,UM_Inventory From Inventory_Mstr Where Part = '{0}' And Location = '{1}';",V.Local.sRet(0).Trim,V.Local.sRet(1).Trim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
		F.Intrinsic.String.Split(V.Local.sRet2,"*!*",V.Local.sRet2)
		F.Intrinsic.Control.If(V.Local.sRet2(0),=,"B")
			Gui.frmQte.optTopLevel.Value(1)
			Gui.frmQte.optComponent.Value(0)
			Gui.frmQte.optTopLevel.Enabled(True)
			Gui.frmQte.optComponent.Enabled(True)
		F.Intrinsic.Control.ElseIf(V.Local.sRet2(0),=,"C")
			Gui.frmQte.optTopLevel.Value(0)
			Gui.frmQte.optComponent.Value(1)
			Gui.frmQte.optTopLevel.Enabled(True)
			Gui.frmQte.optComponent.Enabled(True)
		F.Intrinsic.Control.Else
			Gui.frmQte.optTopLevel.Value(0)
			Gui.frmQte.optComponent.Value(0)
			Gui.frmQte.optTopLevel.Enabled(False)
			Gui.frmQte.optComponent.Enabled(False)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Date.DateAddWorkdays(V.Ambient.Date,V.Local.sRet2(1).Long,62,V.Local.dRet)
		Gui.frmQte.dtpDueDate.Value(V.Local.dRet)
		Gui.frmQte.txtQtyOnHand.Text(V.Local.sRet2(2))
		Gui.frmQte.txtQtyReq.Text(V.Local.sRet2(3))
		Gui.frmQte.txtProdLine.Text(V.Local.sRet2(4))
		Gui.frmQte.txtUM.Text(V.Local.sRet2(5).Trim)
		F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}';",V.Local.sRet(0).Trim,V.Local.sRet(1).Trim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
		F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
			Gui.frmQte.txtRouter.Text("N")
		F.Intrinsic.Control.Else
			Gui.frmQte.txtRouter.Text("Y")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdPart_Click.End

Program.Sub.cmdSave_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iLine.Declare
	V.Local.iLineSuf.Declare
	V.Local.sPrice.Declare
	V.Local.sParent.Declare
	V.Local.sSQL.Declare
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.iCnt.Declare
	V.Local.fQty.Declare
	V.Local.fQtyOnHand.Declare
	V.Local.fQtyReq.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare
	V.Local.iParentLine.Declare
	V.Local.bRouter.Declare
	V.Local.iSourceRow.Declare
	V.Local.iMoveRow.Declare
	V.Local.iTargetRow.Declare
	
	F.Intrinsic.Control.If(V.Screen.frmQte!cboCust.Text,<>,"")
	F.Intrinsic.Control.AndIf(V.Screen.frmQte!cboPart.Text,<>,"")
		F.Intrinsic.Control.If(V.Screen.frmQte!optOrd.Value)
			F.Intrinsic.Control.If(V.Screen.frmQte!txtCustPO.Text,=,"")
				F.Intrinsic.Control.ExitSub
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		Gui.frmQte.txtCustPO.Locked(True)
		Gui.frmQte.frameType.Enabled(False)
		Gui.frmQte.frameSel.Enabled(False)
		
		F.Intrinsic.Control.If(V.DataTable.dtLines.Exists,=,False)
			F.Data.DataTable.Create("dtLines",True)
			F.Data.DataTable.AddColumn("dtLines","Line",Long)
			F.Data.DataTable.AddColumn("dtLines","LineSuf",Long)
			F.Data.DataTable.AddColumn("dtLines","Group",Long)
			F.Data.DataTable.AddColumn("dtLines","ParentLine",Long)
			F.Data.DataTable.AddColumn("dtLines","ParentLine2",String)
			F.Data.DataTable.AddColumn("dtLines","Customer",String)
			F.Data.DataTable.AddColumn("dtLines","CustomerName",String)
			F.Data.DataTable.AddColumn("dtLines","CustPO",String)
			F.Data.DataTable.AddColumn("dtLines","ParentFlag",String)
			F.Data.DataTable.AddColumn("dtLines","BomSeq",String)
			F.Data.DataTable.AddColumn("dtLines","Router",Boolean)
			F.Data.DataTable.AddColumn("dtLines","PartOrig",String)
			F.Data.DataTable.AddColumn("dtLines","Part",String)
			F.Data.DataTable.AddColumn("dtLines","Location",String)
			F.Data.DataTable.AddColumn("dtLines","PartBrw",String)
			F.Data.DataTable.AddColumn("dtLines","Description",String)
			F.Data.DataTable.AddColumn("dtLines","ProdLine",String)
			F.Data.DataTable.AddColumn("dtLines","QtyOrig",Float)
			F.Data.DataTable.AddColumn("dtLines","Qty",Float)
			F.Data.DataTable.AddColumn("dtLines","QtyOnHand",Float)
			F.Data.DataTable.AddColumn("dtLines","QtyReq",Float)
			F.Data.DataTable.AddColumn("dtLines","DueDate",Date)
			F.Data.DataTable.AddColumn("dtLines","Pricing",String)
			F.Data.DataTable.AddColumn("dtLines","UM",String)
			F.Data.DataTable.AddColumn("dtLines","RanKey",Long,V.Global.iRanKey)
			
			V.Local.iLine.Set(V.Screen.frmQte!txtLine.Text)
			V.Local.iLineSuf.Set(V.Screen.frmQte!txtLineSuf.Text)
			F.Intrinsic.Control.If(V.Screen.frmQte!optTopLevel.Enabled)
				V.Local.sParent.Set("Y")
				F.Intrinsic.Control.If(V.Screen.frmQte!optTopLevel.Value)
					V.Local.sPrice.Set("B")
				F.Intrinsic.Control.Else
					V.Local.sPrice.Set("C")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				V.Local.sPrice.Set("N")
				V.Local.sParent.Set("N")
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Screen.frmQte!txtRouter.Text,=,"Y")
				V.Local.bRouter.Set(True)
			F.Intrinsic.Control.Else
				V.Local.bRouter.Set(False)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.Control.If(V.Global.iRow,=,-1)
				F.Data.DataTable.AddRow("dtLines","Line",V.Local.iLine.Format000,"LineSuf",V.Local.iLineSuf.Format0,"ParentLine",V.Local.iLine.Format000,"Customer",V.Screen.frmQte!cboCust.Text,"CustomerName",V.Screen.frmQte!cboCustName.Text,"CustPO",V.Screen.frmQte!txtCustPO.Text,"ParentFlag",V.Local.sParent,"BomSeq","0000","Router",V.Local.bRouter,"PartOrig",V.Screen.frmQte!cboPart.Text,"Part",V.Screen.frmQte!cboPart.Text,"Location",V.Screen.frmQte!cboLoc.Text,"Description",V.Screen.frmQte!txtPartDesc.Text,"ProdLine",V.Screen.frmQte!txtProdLine.Text,"QtyOrig",V.Screen.frmQte!txtQty.Text,"Qty",V.Screen.frmQte!txtQty.Text,"QtyOnHand",V.Screen.frmQte!txtQtyOnHand.Text,"QtyReq",V.Screen.frmQte!txtQtyReq.Text,"DueDate",V.Screen.frmQte!dtpDueDate.Text,"Pricing",V.Local.sPrice,"UM",V.Screen.frmQte!txtUM.Text)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtLines",V.Global.iRow,"Line",V.Local.iLine.Format000,"LineSuf",V.Local.iLineSuf.Format0,"ParentLine",V.Local.iLine.Format000,"Customer",V.Screen.frmQte!cboCust.Text,"CustomerName",V.Screen.frmQte!cboCustName.Text,"CustPO",V.Screen.frmQte!txtCustPO.Text,"ParentFlag",V.Local.sParent,"BomSeq","0000","Router",V.Local.bRouter,"PartOrig",V.Screen.frmQte!cboPart.Text,"Part",V.Screen.frmQte!cboPart.Text,"Location",V.Screen.frmQte!cboLoc.Text,"Description",V.Screen.frmQte!txtPartDesc.Text,"ProdLine",V.Screen.frmQte!txtProdLine.Text,"QtyOrig",V.Screen.frmQte!txtQty.Text,"Qty",V.Screen.frmQte!txtQty.Text,"QtyOnHand",V.Screen.frmQte!txtQtyOnHand.Text,"QtyReq",V.Screen.frmQte!txtQtyReq.Text,"DueDate",V.Screen.frmQte!dtpDueDate.Text,"Pricing",V.Local.sPrice,"UM",V.Screen.frmQte!txtUM.Text)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			V.Local.iLine.Set(V.Screen.frmQte!txtLine.Text)
			V.Local.iLineSuf.Set(V.Screen.frmQte!txtLineSuf.Text)
			F.Intrinsic.Control.If(V.Screen.frmQte!optTopLevel.Enabled)
				V.Local.sParent.Set("Y")
				F.Intrinsic.Control.If(V.Screen.frmQte!optTopLevel.Value,=,1)
					V.Local.sPrice.Set("B")
				F.Intrinsic.Control.Else
					V.Local.sPrice.Set("C")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				V.Local.sPrice.Set("N")
				V.Local.sParent.Set("N")
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Screen.frmQte!txtRouter.Text,=,"Y")
				V.Local.bRouter.Set(True)
			F.Intrinsic.Control.Else
				V.Local.bRouter.Set(False)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.Control.If(V.Global.iRow,=,-1)
				F.Data.DataTable.AddRow("dtLines","Line",V.Local.iLine.Format000,"LineSuf",V.Local.iLineSuf.Format0,"ParentLine",V.Local.iLine.Format000,"Customer",V.Screen.frmQte!cboCust.Text,"CustomerName",V.Screen.frmQte!cboCustName.Text,"CustPO",V.Screen.frmQte!txtCustPO.Text,"ParentFlag",V.Local.sParent,"BomSeq","0000","Router",V.Local.bRouter,"PartOrig",V.Screen.frmQte!cboPart.Text,"Part",V.Screen.frmQte!cboPart.Text,"Location",V.Screen.frmQte!cboLoc.Text,"Description",V.Screen.frmQte!txtPartDesc.Text,"ProdLine",V.Screen.frmQte!txtProdLine.Text,"QtyOrig",V.Screen.frmQte!txtQty.Text,"Qty",V.Screen.frmQte!txtQty.Text,"QtyOnHand",V.Screen.frmQte!txtQtyOnHand.Text,"QtyReq",V.Screen.frmQte!txtQtyReq.Text,"DueDate",V.Screen.frmQte!dtpDueDate.Text,"Pricing",V.Local.sPrice,"UM",V.Screen.frmQte!txtUM.Text)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtLines",V.Global.iRow,"Line",V.Local.iLine.Format000,"LineSuf",V.Local.iLineSuf.Format0,"ParentLine",V.Local.iLine.Format000,"Customer",V.Screen.frmQte!cboCust.Text,"CustomerName",V.Screen.frmQte!cboCustName.Text,"CustPO",V.Screen.frmQte!txtCustPO.Text,"ParentFlag",V.Local.sParent,"BomSeq","0000","Router",V.Local.bRouter,"PartOrig",V.Screen.frmQte!cboPart.Text,"Part",V.Screen.frmQte!cboPart.Text,"Location",V.Screen.frmQte!cboLoc.Text,"Description",V.Screen.frmQte!txtPartDesc.Text,"ProdLine",V.Screen.frmQte!txtProdLine.Text,"QtyOrig",V.Screen.frmQte!txtQty.Text,"Qty",V.Screen.frmQte!txtQty.Text,"QtyOnHand",V.Screen.frmQte!txtQtyOnHand.Text,"QtyReq",V.Screen.frmQte!txtQtyReq.Text,"DueDate",V.Screen.frmQte!dtpDueDate.Text,"Pricing",V.Local.sPrice,"UM",V.Screen.frmQte!txtUM.Text)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		'Add BOM Components
		F.Intrinsic.Control.If(V.Local.sParent,=,"Y")
			F.Intrinsic.String.Build("Select Parent,Sequence_Bom,Part,Quantity From Bom_Mstr Where Parent = '{0}' And Sequence_Bom <> '0000' Order By Sequence_Bom;",V.Screen.frmQte!cboPart.Text,V.Local.sSQL)
			F.Data.DataTable.CreateFromSQL("dtBOM","con",V.Local.sSQL,True)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtBOM.RowCount--,1)
				F.Intrinsic.String.Build("Select Description,Qty_OnHand,Qty_Required,Product_Line,UM_Inventory As UM From Inventory_Mstr Where Part = '{0}' And Location = '{1}';",V.DataTable.dtBOM(V.Local.iCnt).Part!FieldValTrim,V.Screen.frmQte!cboLoc.Text,V.Local.sSql)
				F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
				F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
				F.Intrinsic.Math.Mult(V.Screen.frmQte!txtQty.Text,V.DataTable.dtBOM(V.Local.iCnt).Quantity!FieldVal,V.Local.fQty)
				F.Intrinsic.Control.If(V.Local.sRet(1),=,"OOB")
					V.Local.fQtyOnHand.Set(0)
				F.Intrinsic.Control.Else
					V.Local.fQtyOnHand.Set(V.Local.sRet(1))
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.sRet(2),=,"OOB")
					V.Local.fQtyReq.Set(0)
				F.Intrinsic.Control.Else
					V.Local.fQtyReq.Set(V.Local.sRet(2))
				F.Intrinsic.Control.EndIf

				F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}';",V.DataTable.dtBOM(V.Local.iCnt).Part!FieldValTrim,V.Local.sSql)
				F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
				F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
					V.Local.bRouter.Set(False)
				F.Intrinsic.Control.Else
					V.Local.bRouter.Set(True)
				F.Intrinsic.Control.EndIf
				
				F.Data.DataTable.AddRow("dtLines","Line",V.Local.iLine.Format000,"LineSuf",V.Local.iLineSuf.Format0,"ParentLine",V.Local.iLine.Format000,"Customer",V.Screen.frmQte!cboCust.Text,"CustomerName",V.Screen.frmQte!cboCustName.Text,"CustPO",V.Screen.frmQte!txtCustPO.Text,"ParentFlag",V.Screen.frmQte!cboPart.Text,"BomSeq",V.DataTable.dtBOM(V.Local.iCnt).Sequence_Bom!FieldVal,"Router",V.Local.bRouter,"PartOrig",V.DataTable.dtBOM(V.Local.iCnt).Part!FieldValTrim,"Part",V.DataTable.dtBOM(V.Local.iCnt).Part!FieldValTrim,"Location",V.Screen.frmQte!cboLoc.Text,"Description",V.Local.sRet(0),"ProdLine",V.Local.sRet(3),"QtyOrig",V.DataTable.dtBOM(V.Local.iCnt).Quantity!FieldVal,"Qty",V.Local.fQty,"QtyOnHand",V.Local.fQtyOnHand,"QtyReq",V.Local.fQtyReq,"DueDate",V.Screen.frmQte!dtpDueDate.Text,"Pricing","","UM",V.Local.sRet(4))
				
				F.Intrinsic.Control.If(V.Local.iCnt,=,0)
					F.Data.DataTable.MoveRow("dtLines",V.DataTable.dtLines.RowCount--,V.Local.iLine)
				F.Intrinsic.Control.Else
					F.Data.DataTable.MoveRow("dtLines",V.DataTable.dtLines.RowCount--,V.Local.iLine.++)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
			F.Data.DataTable.Close("dtBOM")
		F.Intrinsic.Control.EndIf
		
		F.Data.DataTable.SetSeries("dtLines","Line",1,1)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtLines.RowCount--,1)
				F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim)
					F.Intrinsic.Control.CaseAny("N","Y")
						F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
						V.Local.iParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
					F.Intrinsic.Control.CaseElse
						F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.Local.iParentLine)
				F.Intrinsic.Control.EndSelect
			F.Intrinsic.Control.Next(V.Local.iCnt)
			
		F.Intrinsic.Control.CallSub(LoadGVLines)
		F.Intrinsic.Control.CallSub(Clear)
		F.Data.DataTable.Compute("dtLines","Max(Line)","",V.Local.iLine)
		F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
		Gui.frmQte.txtLine.Text(V.Local.iLine.Format000)
		V.Global.iRow.Set(-1)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSave_Click.End

Program.Sub.LoadGVLines.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.iNext.Declare
	V.Local.sParentLine.Declare
	V.Local.sParentLine2.Declare
	V.Local.sNextParentLine.Declare
	V.Local.sColor.Declare
	V.Local.sComponent.Declare
	
	F.Intrinsic.Control.If(V.Global.bGroup,=,False)	
		Gui.frmQte.GsGCLines.AddGridviewFromDatatable("gvLines","dtLines")
		Gui.frmQte.GsGCLines.SuspendLayout()
		Gui.frmQte.GsGCLines.SetGridViewProperty("gvLines","MultiSelect",True)
		Gui.frmQte.GsGCLines.SetGridViewProperty("gvLines","AllowSort",True)
		Gui.frmQte.GsGCLines.SetGridViewProperty("gvLines","AllowFilter",True)
		Gui.frmQte.GsGCLines.SetGridViewProperty("gvLines","OptionsDetailShowDetailTabs",False)
		Gui.frmQte.GsGCLines.SetGridViewProperty("gvLines","OptionsViewShowGroupPanel",True)
		
		Gui.frmQte.GsGCLines.ColumnEdit("gvLines","Part","Combobox",V.Global.sValues)
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","LineSuf","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Customer","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustomerName","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustPO","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentFlag","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartOrig","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyOrig","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Pricing","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","UM","Visible",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","RanKey","Visible",False)
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartBrw","ShowCaption",False)
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Line","Caption","Line")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","LineSuf","Caption","Suf")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Group","Caption","Group")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","Caption","Parent Line")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","Caption","Top Level")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Customer","Caption","Customer")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustomerName","Caption","Cust Name")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustPO","Caption","Customer PO")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentFlag","Caption","Parent")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","Caption","BOM Seq")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Router","Caption","Router")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartOrig","Caption","Part Orig")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Part","Caption","Part")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Location","Caption","Loc")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Description","Caption","Description")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ProdLine","Caption","PL")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Qty","Caption","Qty")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyOnHand","Caption","Qty On Hand")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyReq","Caption","Qty Req")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","DueDate","Caption","Due Date")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Pricing","Caption","Pricing")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","UM","Caption","UM")
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Line","MinWidth","40")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","LineSuf","MinWidth","30")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Group","MinWidth","40")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","MinWidth","30")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","MinWidth","30")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Customer","MinWidth","60")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustomerName","MinWidth","150")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustPO","MinWidth","75")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentFlag","MinWidth","115")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","MinWidth","40")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Router","MinWidth","50")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartOrig","MinWidth","115")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Part","MinWidth","115")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Location","MinWidth","40")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartBrw","MinWidth","30")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Description","MinWidth","150")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ProdLine","MinWidth","40")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Qty","MinWidth","75")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyOnHand","MinWidth","75")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyReq","MinWidth","75")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","DueDate","MinWidth","80")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Pricing","MinWidth","50")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","UM","MinWidth","50")
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Line","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","LineSuf","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Group","AllowEdit",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Customer","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustomerName","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustPO","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentFlag","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Router","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartOrig","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Part","AllowEdit",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Location","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartBrw","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Description","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ProdLine","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Qty","AllowEdit",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyOnHand","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyReq","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","DueDate","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Pricing","AllowEdit",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","UM","AllowEdit",False)
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Group","ReadOnly",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Part","ReadOnly",False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Qty","ReadOnly",False)
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Line","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","LineSuf","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Group","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Customer","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustomerName","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustPO","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentFlag","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Router","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartOrig","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Part","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Location","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Description","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ProdLine","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Qty","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyOnHand","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyReq","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","DueDate","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Pricing","HeaderFontBold",True)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","UM","HeaderFontBold",True)
	
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Line","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","LineSuf","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Group","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Customer","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustomerName","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","CustPO","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentFlag","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Router","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","PartOrig","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Part","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Location","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Description","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ProdLine","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Qty","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyOnHand","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","QtyReq","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","DueDate","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Pricing","HeaderHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","UM","HeaderHAlignment","Center")
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Line","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","LineSuf","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Group","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Customer","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Router","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Location","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ProdLine","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","DueDate","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Pricing","CellHAlignment","Center")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","UM","CellHAlignment","Center")
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","Line","DisplayCustomNumeric","000")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine","DisplayCustomNumeric","000")
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","BomSeq","DisplayCustomNumeric","0000")
		
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","DueDate","DisplayCustomDatetime","d")
	F.Intrinsic.Control.EndIf
	
	'Alternate Colors per Part/Parent
	Gui.frmQte.GsGCLines.SuspendLayout()
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtLines.RowCount--,1)
		F.Intrinsic.Math.Add(V.Local.iCnt,1,V.Local.iNext)
		F.Intrinsic.Control.If(V.Local.iCnt,=,0)
			V.Local.sParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
			F.Intrinsic.Control.If(V.Local.iNext,=<,V.DataTable.dtLines.RowCount--)
				V.Local.sNextParentLine.Set(V.DataTable.dtLines(V.Local.iNext).ParentLine!FieldValTrim)
			F.Intrinsic.Control.EndIf
			V.Local.sColor.Set("None")
			Gui.frmQte.GsGCLines.SetRowAppearance("gvLines",V.Local.iCnt,"BackColor","LightGray")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.sColor,=,"None")
				F.Intrinsic.Control.If(V.Local.sNextParentLine,=,V.Local.sParentLine)
					V.Local.sParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.iNext,=<,V.DataTable.dtLines.RowCount--)
						V.Local.sNextParentLine.Set(V.DataTable.dtLines(V.Local.iNext).ParentLine!FieldValTrim)
					F.Intrinsic.Control.EndIf
					V.Local.sColor.Set("None")
					Gui.frmQte.GsGCLines.SetRowAppearance("gvLines",V.Local.iCnt,"BackColor","LightGray")
				F.Intrinsic.Control.Else
					V.Local.sParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.iNext,=<,V.DataTable.dtLines.RowCount--)
						V.Local.sNextParentLine.Set(V.DataTable.dtLines(V.Local.iNext).ParentLine!FieldValTrim)
					F.Intrinsic.Control.EndIf
					Gui.frmQte.GsGCLines.SetRowAppearance("gvLines",V.Local.iCnt,"BackColor","LightGreen")
					V.Local.sColor.Set("LightGreen")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Local.sNextParentLine,=,V.Local.sParentLine)
					V.Local.sParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.iNext,=<,V.DataTable.dtLines.RowCount--)
						V.Local.sNextParentLine.Set(V.DataTable.dtLines(V.Local.iNext).ParentLine!FieldValTrim)
					F.Intrinsic.Control.EndIf
					Gui.frmQte.GsGCLines.SetRowAppearance("gvLines",V.Local.iCnt,"BackColor","LightGreen")
					V.Local.sColor.Set("LightGreen")
				F.Intrinsic.Control.Else
					V.Local.sParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.iNext,=<,V.DataTable.dtLines.RowCount--)
						V.Local.sNextParentLine.Set(V.DataTable.dtLines(V.Local.iNext).ParentLine!FieldValTrim)
					F.Intrinsic.Control.EndIf
					V.Local.sColor.Set("None")
					Gui.frmQte.GsGCLines.SetRowAppearance("gvLines",V.Local.iCnt,"BackColor","LightGray")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentFlag",V.Local.iCnt,V.Local.sComponent)
		F.Intrinsic.Control.If(V.Local.sComponent,<>,"Y",AND,V.Local.sComponent,<>,"N")
'			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",12,V.Local.iCnt,"ForeColor","Blue")
'			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",12,V.Local.iCnt,"FontUnderline",True)
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",14,V.Local.iCnt,"Icon","BROWSE")
			Gui.frmQte.GsGCLines.SetCellProperty("gvLines",2,V.Local.iCnt,"Locked",True)
			Gui.frmQte.GsGCLines.SetCellProperty("gvLines",18,V.Local.iCnt,"Locked",True)
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",12,V.Local.iCnt,"BackColor","LightYellow")
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",12,V.Local.iCnt,"HAlignment","Near")
		F.Intrinsic.Control.Else
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",2,V.Local.iCnt,"BackColor","LightYellow")
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",2,V.Local.iCnt,"HAlignment","Center")
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",18,V.Local.iCnt,"BackColor","LightYellow")
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",18,V.Local.iCnt,"HAlignment","Far")
			Gui.frmQte.GsGCLines.SetCellProperty("gvLines",12,V.Local.iCnt,"Locked",True)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iCnt).QtyReq!FieldVal,>,V.DataTable.dtLines(V.Local.iCnt).QtyOnHand!FieldVal)
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",19,V.Local.iCnt,"BackColor","Pink")
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",19,V.Local.iCnt,"HAlignment","Far")
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",20,V.Local.iCnt,"BackColor","Pink")
			Gui.frmQte.GsGCLines.SetCellAppearance("gvLines",20,V.Local.iCnt,"HAlignment","Far")
		F.Intrinsic.Control.EndIf
		
'		F.Intrinsic.Control.If(V.Local.sComponent,=,"Y",OR,V.Local.sComponent,=,"N")
'		F'Intrinsic.Control.If(V.Local.sComponent,=,"Y")
'			Gui.frmQte.GsGCLines.SetRowAppearance("gvLines",V.Local.iCnt,"BackColor","LightYellow")
'		F.Intrinsic.Control.EndIf
		
		V.Local.sParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldVal)
		F.Intrinsic.Control.If(V.Local.sComponent,=,"Y",OR,V.Local.sComponent,=,"N")
			F.Intrinsic.String.Build("{0}-{1}",V.Local.sParentLine.Format000,V.DataTable.dtLines(V.Local.iCnt).Part!FieldValTrim,V.Local.sParentLine2)
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("{0}-{1}",V.Local.sParentLine.Format000,V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim,V.Local.sParentLine2)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine2",V.Local.sParentLine2)
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Intrinsic.Control.If(V.Global.bGroup,=,False)
		Gui.frmQte.GsGCLines.SetColumnProperty("gvLines","ParentLine2","GroupIndex",0)
		Gui.frmQte.GsGCLines.ResumeLayout()
		Gui.frmQte.GsGCLines.MainView("gvLines")
		V.Global.bGroup.Set(True)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGVLines.End

Program.Sub.GsGCLines_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iLine.Declare
	V.Local.sSQL.Declare
	V.Local.sPart.Declare
	V.Local.sParent.Declare
	V.Local.sComponent.Declare
	V.Local.bRouter.Declare
	V.Local.sParams.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	
	Gui.frmOpts.tabSelections.TabVisible(0,True)
	Gui.frmOpts.tabSelections.SetTab(0)
	
	F.Intrinsic.Control.BlockEvents
	
	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("PartBrw")
			V.Global.iRowOpt.Set(V.Args.RowIndex)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentFlag",V.Args.RowIndex,V.Local.sParent)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","PartOrig",V.Args.RowIndex,V.Local.sComponent)
			F.Intrinsic.Control.If(V.Local.sParent,<>,"Y",AND,V.Local.sParent,<>,"N")
				F.Intrinsic.Control.If(V.DataTable.dtOpts.Exists)
					F.Data.DataTable.Close("dtOpts")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("Select * From GAB_4812_BOM_CONFIG Where Parent = '{0}' And Component = '{1}' Order By Options;",V.Local.sParent,V.Local.sComponent,V.Local.sSQL)
				F.Data.DataTable.CreateFromSQL("dtOpts","con",V.Local.sSQL,True)
				F.Data.DataTable.AddColumn("dtOpts","Description",String)
				F.Data.Dictionary.CreateFromSQL("dDesc","con","Select Part,Description From V_Inventory_Mstr Order By Part,Location;")
				F.Data.Dictionary.SetDefaultReturn("dDesc","Non-Inventory Part")
				F.Data.DataTable.FillFromDictionary("dtOpts","dDesc","Options","Description")
				F.Data.Dictionary.Close("dDesc")
				
				Gui.frmOpts.GsGCOpts.AddGridviewFromDatatable("gvOpts","dtOpts")
				Gui.frmOpts.GsGCOpts.SuspendLayout()
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","MultiSelect",True)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","AllowSort",True)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","AllowFilter",True)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","ReadOnly",True)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","Editable",False)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","OptionsDetailShowDetailTabs",False)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","OptionsViewShowGroupPanel",False)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","Enableappearanceoddrow",False)
				Gui.frmOpts.GsGCOpts.SetGridViewProperty("gvOpts","OptionsFindAlwaysVisible",True)
			
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","CID","Visible",False)
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Parent","Visible",False)
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Component","Visible",False)
				
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","CID","Caption","CID")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Parent","Caption","Parent")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Component","Caption","Component")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Options","Caption","Option(s)")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Description","Caption","Description")
				
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","CID","MinWidth","40")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Parent","MinWidth","100")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Component","MinWidth","100")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Options","MinWidth","100")
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Description","MinWidth","250")
				
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","CID","HeaderFontBold",True)
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Parent","HeaderFontBold",True)
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Component","HeaderFontBold",True)
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Options","HeaderFontBold",True)
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","Description","HeaderFontBold",True)
			
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","CID","HeaderHAlignment","Center")
				
				Gui.frmOpts.GsGCOpts.SetColumnProperty("gvOpts","CID","CellHAlignment","Center")
				
				Gui.frmOpts.GsGCOpts.ResumeLayout()
				Gui.frmOpts.GsGCOpts.MainView("gvOpts")
				F.Intrinsic.Control.CallSub(LoadInvSearch)
				Gui.frmOpts..Show
				
			F.Intrinsic.Control.Case(Router)
				Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","Router",V.Args.RowIndex,V.Local.bRouter)
				Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","Part",V.Args.RowIndex,V.Local.sPart)
				F.Intrinsic.Control.If(V.Local.bRouter)
					F.Intrinsic.String.ConcatCallWrapperArgs("O",V.Local.sPart,V.Local.sParams)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.ConcatCallWrapperArgs("N",V.Local.sPart,V.Local.sParams)
					Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","Router",V.Args.RowIndex,True)
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperAsync(400000,V.Local.sParams)
			
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.If(V.Args.Clicks,=,2)
		Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentFlag",V.Args.RowIndex,V.Local.sParent)
		F.Intrinsic.Control.SelectCase(V.Local.sParent)
			F.Intrinsic.Control.CaseAny("Y","N")
				V.Local.iLine.Set(V.DataTable.dtLines(V.Args.RowIndex).Line!FieldVal)
				Gui.frmQte.txtLine.Text(V.Local.iLine.Format000)
				Gui.frmQte.txtLineSuf.Text(V.DataTable.dtLines(V.Args.RowIndex).LineSuf!FieldVal)
				Gui.frmQte.cboPart.Text(V.DataTable.dtLines(V.Args.RowIndex).Part!FieldValTrim)
				Gui.frmQte.cboLoc.Text(V.DataTable.dtLines(V.Args.RowIndex).Location!FieldValTrim)
				Gui.frmQte.txtPartDesc.Text(V.DataTable.dtLines(V.Args.RowIndex).Description!FieldValTrim)
				Gui.frmQte.txtQty.Text(V.DataTable.dtLines(V.Args.RowIndex).Qty!FieldVal)
				Gui.frmQte.txtQtyOnHand.Text(V.DataTable.dtLines(V.Args.RowIndex).QtyOnHand!FieldVal)
				Gui.frmQte.txtQtyReq.Text(V.DataTable.dtLines(V.Args.RowIndex).QtyReq!FieldVal)
				Gui.frmQte.txtProdLine.Text(V.DataTable.dtLines(V.Args.RowIndex).ProdLine!FieldVal)
				Gui.frmQte.dtpDueDate.Text(V.DataTable.dtLines(V.Args.RowIndex).DueDate!FieldVal)
				Gui.frmQte.txtUM.Text(V.DataTable.dtLines(V.Args.RowIndex).UM!FieldVal)
				F.Intrinsic.Control.If(V.DataTable.dtLines(V.Args.RowIndex).Pricing!FieldValTrim,=,"B")
					Gui.frmQte.optTopLevel.Value(1)
					Gui.frmQte.optComponent.Value(0)
					Gui.frmQte.optTopLevel.Enabled(True)
					Gui.frmQte.optComponent.Enabled(True)
				F.Intrinsic.Control.ElseIf(V.DataTable.dtLines(V.Args.RowIndex).Pricing!FieldValTrim,=,"C")
					Gui.frmQte.optTopLevel.Value(0)
					Gui.frmQte.optComponent.Value(1)
					Gui.frmQte.optTopLevel.Enabled(True)
					Gui.frmQte.optComponent.Enabled(True)
				F.Intrinsic.Control.Else
					Gui.frmQte.optTopLevel.Value(0)
					Gui.frmQte.optComponent.Value(0)
					Gui.frmQte.optTopLevel.Enabled(False)
					Gui.frmQte.optComponent.Enabled(False)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.DataTable.dtLines(V.Args.RowIndex).Router!FieldValTrim)
					Gui.frmQte.txtRouter.Text("Y")
				F.Intrinsic.Control.Else
					Gui.frmQte.txtRouter.Text("N")
				F.Intrinsic.Control.EndIf
				V.Global.iRow.Set(V.Args.RowIndex)
		F.Intrinsic.Control.EndSelect
		
		F.Intrinsic.Control.If(V.Local.sParent,=,"Y")
			F.Intrinsic.String.Build("ParentLine = {0}",V.DataTable.dtLines(V.Args.RowIndex).ParentLine!FieldVal,V.Local.sExp)
			F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
			F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
				F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
				F.Intrinsic.Control.For(V.Local.iCnt,V.Local.sSelect.UBound,1,-1)
					F.Data.DataTable.DeleteRow("dtLines",V.Local.sSelect(V.Local.iCnt).Long)
				F.Intrinsic.Control.Next(V.Local.iCnt)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.CallSub(LoadGVLines)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.UnBlockEvents
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCLines_RowCellClick.End

Program.Sub.GsGCLines_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sExp.Declare
	V.Local.sSelect.Declare
	V.Local.iCnt.Declare
	V.Local.fQty.Declare
	V.Local.sFilter.Declare
	V.Local.dRet.Declare
	V.Local.sSql.Declare
	V.Local.sRet2.Declare
	V.Local.bRouter.Declare

	F.Intrinsic.Control.SelectCase(V.Args.Column)
		F.Intrinsic.Control.Case("Part")
			F.Intrinsic.String.Build("Part = '{0}'",V.Args.Value,V.Local.sFilter)
			F.Data.DataTable.Select("dtPart",V.Local.sFilter,V.Local.sSelect)
			F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
				F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","Part",V.Args.RowIndex,V.DataTable.dtPart(V.Local.sSelect(0).Long).Part!FieldVal)
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","Description",V.Args.RowIndex,V.DataTable.dtPart(V.Local.sSelect(0).Long).Description!FieldVal)
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","QtyOnHand",V.Args.RowIndex,V.DataTable.dtPart(V.Local.sSelect(0).Long).Qty_OnHand!FieldVal)
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","QtyReq",V.Args.RowIndex,V.DataTable.dtPart(V.Local.sSelect(0).Long).Qty_Required!FieldVal)
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","ProdLine",V.Args.RowIndex,V.DataTable.dtPart(V.Local.sSelect(0).Long).Product_Line!FieldVal)
				F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}';",V.Args.Value,V.Local.sSql)
				F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
				F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
					V.Local.bRouter.Set(False)
				F.Intrinsic.Control.Else
					V.Local.bRouter.Set(True)
				F.Intrinsic.Control.EndIf
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","Router",V.Args.RowIndex,V.Local.bRouter)
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.Case("Qty")
			F.Intrinsic.String.Build("ParentLine = {0}",V.DataTable.dtLines(V.Args.RowIndex).ParentLine!FieldVal,V.Local.sExp)
			F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
			F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
				F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
				F.Intrinsic.Control.For(V.Local.iCnt,1,V.Local.sSelect.UBound,1)
					F.Intrinsic.Math.Mult(V.Args.Value,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt).Long).QtyOrig!FieldValFloat,V.Local.fQty)
					F.Data.DataTable.SetValue("dtLines",V.Local.sSelect(V.Local.iCnt).Long,"Qty",V.Local.fQty)
				F.Intrinsic.Control.Next(V.Local.iCnt)
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCLines_CellValueChanged.End

Program.Sub.LoadInvSearch.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.If(V.DataTable.dtInv.Exists)
		F.Data.DataTable.Close("dtInv")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.CreateFromSQL("dtInv","con","Select Part,Location,Description,Amt_Price From V_Inventory_Mstr Order By Part,Location;",True)
	
	Gui.frmOpts.GsGCInv.AddGridviewFromDatatable("gvInv","dtInv")
	Gui.frmOpts.GsGCInv.SuspendLayout()
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","MultiSelect",True)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","AllowSort",True)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","AllowFilter",True)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","ReadOnly",True)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","Editable",False)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","OptionsDetailShowDetailTabs",False)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","OptionsViewShowGroupPanel",False)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","Enableappearanceoddrow",False)
	Gui.frmOpts.GsGCInv.SetGridViewProperty("gvInv","OptionsFindAlwaysVisible",True)

	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Part","Caption","Part")
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Location","Caption","Loc")
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Description","Caption","Description")
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Amt_Price","Caption","Price")
	
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Part","MinWidth","150")
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Location","MinWidth","45")
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Description","MinWidth","250")
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Amt_Price","MinWidth","85")
	
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Part","HeaderFontBold",True)
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Location","HeaderFontBold",True)
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Description","HeaderFontBold",True)
	Gui.frmOpts.GsGCInv.SetColumnProperty("gvInv","Amt_Price","HeaderFontBold",True)

	Gui.frmOpts.GsGCInv.ResumeLayout()
	Gui.frmOpts.GsGCInv.MainView("gvInv")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadInvSearch.End

Program.Sub.frmOpts_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmOpts..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmOpts_UnLoad.End

Program.Sub.GsGCOpts_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.sSql.Declare
	V.Local.sMsg.Declare
	V.Local.sComponent.Declare
	V.Local.bRouter.Declare
	V.Local.iLine.Declare
	V.Local.iLineSuf.Declare
	V.Local.sParent.Declare
	V.Local.iParentLine.Declare
	V.Local.iBomSeq.Declare
	V.Local.fQty.Declare
	V.Local.fQtyOnHand.Declare
	V.Local.fQtyReq.Declare
	V.Local.dDueDate.Declare
	V.Local.iQty.Declare
	V.Local.iOrigQty.Declare
	V.Local.iParentQty.Declare
	V.Local.iCnt.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare
	
	F.Intrinsic.Control.If(V.Args.Clicks,=,2)
		F.Intrinsic.Control.If(V.Screen.frmOpts!tabSelections.Tab,=,1)
			Gui.frmOpts.GsGCOpts.GetCellValueByColumnName("gvOpts","Options",V.Args.RowIndex,V.Local.sComponent)
		F.Intrinsic.Control.Else
			Gui.frmOpts.GsGCInv.GetCellValueByColumnName("gvInv","Part",V.Args.RowIndex,V.Local.sComponent)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.If(V.Global.bAddComp,=,False)
			F.Intrinsic.String.Build("Select Description,Qty_OnHand,Qty_Required,Product_Line From V_Inventory_Mstr Where Part = '{0}' And Location = '{1}';",V.Local.sComponent.Trim,V.DataTable.dtLines(V.Global.iRowOpt).Location!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
			F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF,=,False)
				F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","Part",V.Global.iRowOpt,V.Local.sComponent.Trim)
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","Description",V.Global.iRowOpt,V.Local.sRet(0))
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","QtyOnHand",V.Global.iRowOpt,V.Local.sRet(1))
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","QtyReq",V.Global.iRowOpt,V.Local.sRet(2))
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","ProdLine",V.Global.iRowOpt,V.Local.sRet(3))
				F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}';",V.Local.sComponent.Trim,V.Local.sSql)
				F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
				F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
					V.Local.bRouter.Set(False)
				F.Intrinsic.Control.Else
					V.Local.bRouter.Set(True)
				F.Intrinsic.Control.EndIf
				Gui.frmQte.GsGCLines.SetCellValueByColumnName("gvLines","Router",V.Global.iRowOpt,V.Local.bRouter)
				Gui.frmOpts..Visible(False)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0} is not an inventory part.",V.Local.sComponent.Trim,V.Local.sMsg)
				F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Message")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Else
			Gui.frmOpts..Visible(False)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","Line",V.Global.iRowAddComp,V.Local.iLine)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","LineSuf",V.Global.iRowAddComp,V.Local.iLineSuf)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentFlag",V.Global.iRowAddComp,V.Local.sParent)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","ParentLine",V.Global.iRowAddComp,V.Local.iParentLine)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","BomSeq",V.Global.iRowAddComp,V.Local.iBomSeq)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","DueDate",V.Global.iRowAddComp,V.Local.dDueDate)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","QtyOrig",V.Global.iRowAddComp,V.Local.iOrigQty)
			Gui.frmQte.GsGCLines.GetCellValueByColumnName("gvLines","Qty",V.Global.iRowAddComp,V.Local.iQty)
			F.Intrinsic.String.Build("Select Description,Qty_OnHand,Qty_Required,Product_Line From Inventory_Mstr Where Part = '{0}' Order By Location;",V.Local.sComponent,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
			F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
			F.Intrinsic.Control.CallSub(EnterQty)
			F.Intrinsic.Math.Div(V.Local.iQty,V.Local.iOrigQty,V.Local.iParentQty)
			F.Intrinsic.Math.Mult(V.Local.iParentQty,V.Screen.frmQty!txtQty.Text,V.Local.fQty)
			F.Intrinsic.Control.If(V.Local.sRet(1),=,"OOB")
				V.Local.fQtyOnHand.Set(0)
			F.Intrinsic.Control.Else
				V.Local.fQtyOnHand.Set(V.Local.sRet(1))
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.sRet(2),=,"OOB")
				V.Local.fQtyReq.Set(0)
			F.Intrinsic.Control.Else
				V.Local.fQtyReq.Set(V.Local.sRet(2))
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}';",V.Local.sComponent,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
			F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
				V.Local.bRouter.Set(False)
			F.Intrinsic.Control.Else
				V.Local.bRouter.Set(True)
			F.Intrinsic.Control.EndIf
			
			'BomSeq
			F.Intrinsic.String.Build("ParentLine = {0}",V.Local.iParentLine,V.Local.sExp)
			F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
			F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
			F.Intrinsic.Math.Add(V.DataTable.dtLines(V.Local.sSelect(V.Local.sSelect.UBound)).BomSeq!FieldVal,V.Global.iBomSeq,V.Local.iBomSeq)

			F.Data.DataTable.AddRow("dtLines","Line",V.Local.iLine.Format000,"LineSuf",V.Local.iLineSuf.Format0,"ParentLine",V.Local.iLine.Format000,"Customer",V.Screen.frmQte!cboCust.Text,"CustomerName",V.Screen.frmQte!cboCustName.Text,"CustPO",V.Screen.frmQte!txtCustPO.Text,"ParentFlag",V.Local.sParent.Trim,"BomSeq",V.Local.iBomSeq.Format0000,"Router",V.Local.bRouter,"PartOrig",V.Local.sComponent.Trim,"Part",V.Local.sComponent.Trim,"Location","","Description",V.Local.sRet(0).Trim,"ProdLine",V.Local.sRet(3).Trim,"QtyOrig",V.Screen.frmQty!txtQty.Text,"Qty",V.Local.fQty,"QtyOnHand",V.Local.fQtyOnHand,"QtyReq",V.Local.fQtyReq,"DueDate",V.Local.dDueDate,"Pricing","")
			
'			F.Data.DataTable.MoveRow("dtLines",V.DataTable.dtLines.RowCount--,V.Global.iRowAddComp.++)
			F.Data.DataTable.MoveRow("dtLines",V.DataTable.dtLines.RowCount--,V.Local.sSelect(V.Local.sSelect.UBound).++)
				
			F.Data.DataTable.SetSeries("dtLines","Line",1,1)
			'Set Parent Lines
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtLines.RowCount--,1)
				F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim)
					F.Intrinsic.Control.CaseAny("N","Y")
						F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
						V.Local.iParentLine.Set(V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal)
					F.Intrinsic.Control.CaseElse
						F.Data.DataTable.SetValue("dtLines",V.Local.iCnt,"ParentLine",V.Local.iParentLine)
				F.Intrinsic.Control.EndSelect
			F.Intrinsic.Control.Next(V.Local.iCnt)
			F.Intrinsic.Control.CallSub(LoadGVLines)
		F.Intrinsic.Control.EndIf
		V.Global.bAddComp.Set(False)
		F.Data.DataTable.Compute("dtLines","Max(Line)","",V.Local.iLine)
		F.Intrinsic.Math.Add(V.Local.iLine,1,V.Local.iLine)
		Gui.frmQte.txtLine.Text(V.Local.iLine.Format000)
		Gui.frmQty.txtQty.Text("")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCOpts_RowCellClick.End

Program.Sub.EnterQty.Start
		F.Intrinsic.Control.Try
		V.Local.sError.Declare
	
		Gui.frmQty..Show
		Gui.frmQty..AlwaysOnTop(True)
		Gui.frmQty.txtQty.SetFocus
		Gui.frmQty..WaitForDismiss
	
		F.Intrinsic.Control.Catch
			F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
			F.Intrinsic.UI.Msgbox(V.Local.sError)
			F.Intrinsic.Control.End 
		F.Intrinsic.Control.EndTry
Program.Sub.EnterQty.End

Program.Sub.cmdOK_Click.Start
	V.Local.sMsg.Declare
	V.Local.sQty.Declare
	
	V.Local.sQty.Set(V.Screen.frmQty!txtQty.Text)
	F.Intrinsic.Control.If(V.Local.sQty.Trim,=,"")
		F.Intrinsic.UI.Msgbox("Please enter in a Quantity.","Quantity Check")
	F.Intrinsic.Control.Else
		Gui.frmQty..Visible(False)
	F.Intrinsic.Control.EndIf
Program.Sub.cmdOK_Click.End

Program.Sub.OptNewAdd.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Screen.frmQte!optNew.Value)
		Gui.frmQte.txtQuote.Text("")
		Gui.frmQte.txtLastLine.Text("")
		Gui.frmQte.txtQuote.Visible(False)
		Gui.frmQte.cmdQteBrw.Visible(False)
		Gui.frmQte.cmdCust.Enabled(True)
		Gui.frmQte.txtCustPO.Enabled(True)
		Gui.frmQte.cboCust.Enabled(True)
		Gui.frmQte.cboCustName.Enabled(True)
	F.Intrinsic.Control.Else
		Gui.frmQte.txtQuote.Visible(True)
		Gui.frmQte.cmdQteBrw.Visible(True)
		Gui.frmQte.cmdCust.Enabled(False)
		Gui.frmQte.txtCustPO.Enabled(False)
		Gui.frmQte.cboCust.Enabled(False)
		Gui.frmQte.cboCustName.Enabled(False)
	F.Intrinsic.Control.EndIf
	
	Gui.frmQte.cboCust.Text("")
	Gui.frmQte.cboCustName.Text("")
	F.Intrinsic.Control.If(V.DataTable.dtLines.Exists)
		Gui.frmQte.GsGCLines.ClearRows("gvLines")
		F.Intrinsic.Control.CallSub(Clear)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.OptNewAdd.End

Program.Sub.OptQteSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmQte.txtQuote.Text("")
	Gui.frmQte.txtLastLine.Text("")
	Gui.frmQte.chkAutoWO.Value(0)
	Gui.frmQte.chkAutoWO.Enabled(False)
	Gui.frmQte.txtCustPO.Text("")
	Gui.frmQte.txtCustPO.Visible(False)
	Gui.frmQte.lblCustPO.Visible(False)
	
	F.Intrinsic.Control.If(V.Screen.frmQte!optOrd.Value)
		Gui.frmQte.chkAutoWO.Enabled(True)
		Gui.frmQte.txtCustPO.Visible(True)
		Gui.frmQte.lblCustPO.Visible(True)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.OptQteSO.End

Program.Sub.cmdQteBrw_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sRet.Declare
	
	F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		F.Intrinsic.UI.Browser("Quotes","con","SELECT A.QUOTE_NO,A.CUSTOMER,B.NAME_CUSTOMER,DATE_DUE,CUSTOMER_PO FROM QUOTE_HEADER A LEFT JOIN V_CUSTOMER_MASTER B ON A.CUSTOMER = B.CUSTOMER WHERE QUOTE_NO <> '' AND RECORD_NO = '  A' ORDER BY A.QUOTE_NO;","Quote No*!*Cust No*!*Customer Name*!*Due Date*!*Customer PO","100*!*100*!*300*!*85*!*100",V.Local.sRet)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Browser("Sales Orders","con","SELECT A.ORDER_NO,A.CUSTOMER,C.NAME_CUSTOMER_SHIP,A.CUSTOMER_PO,C.ADDRESS_1_SHIP,C.CITY_SHIP,C.CODE_ZIP_SHIP FROM V_ORDER_HEADER A LEFT OUTER JOIN ORDER_SHIP_TO C ON A.ORDER_NO = C.ORDER_NO AND A.SHIP_ID = C.ORDER_SHIP_ID AND C.RECORD_NO = '  C ' ORDER BY A.ORDER_NO;","Order No*!*Cust No*!*Customer Name*!*Customer PO*!*Address 1*!*City*!*Zip","100*!*100*!*300*!*100*!*100*!*80*!*50",V.Local.sRet)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
		F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
		V.Global.sQuoteNo.Set(V.Local.sRet(0))
		Gui.frmQte.txtQuote.Text(V.Local.sRet(0))
		Gui.frmQte.cboCust.Text(V.Local.sRet(1))
		Gui.frmQte.cboCustName.Text(V.Local.sRet(2))
		Gui.frmQte.txtCustPO.Text(V.Local.sRet(3))
		Gui.frmQte.txtCustPO.Locked(True)
		F.Intrinsic.Control.CallSub(GenerateKey)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdQteBrw_Click.End

Program.Sub.cmdProcess_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sPart.Declare
	V.Local.sFilter.Declare
	V.Local.iCnt.Declare
	V.Local.iCount.Declare
	V.Local.bDuplicates.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtTopLevels.Exists)
		F.Data.DataTable.Close("dtTopLevels")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataView.Create("dtLines","dvTopLevels")
	F.Data.DataView.ToDataTableDistinct("dtLines","dvTopLevels","dtTopLevels","Part",True)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtTopLevels.RowCount--,1)
		F.Intrinsic.String.Replace(V.DataTable.dtTopLevels(V.Local.iCnt).Part!FieldValTrim,"'","''",V.Local.sPart)
		F.Intrinsic.String.Build("Part = '{0}'",V.Local.sPart,V.Local.sFilter)
		F.Data.DataTable.Compute("dtLines","Count(Part)",V.Local.sFilter,V.Local.iCount)
		F.Intrinsic.Control.If(V.Local.iCount,>,1)
			V.Local.bDuplicates.Set(True)
			F.Intrinsic.Control.ExitFor(V.Local.iCnt)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Data.DataView.Close("dtLines","dvTopLevels")
	
	F.Intrinsic.Control.If(V.Screen.frmQte!optNew.Value)
		F.Intrinsic.Control.If(V.Local.bDuplicates,=,False)
			F.Intrinsic.Control.CallSub(ProcessNew)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.CallSub(ProcessNewOne)
			F.Intrinsic.Control.CallSub(ProcessExistingOne,"Call","Second")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.Local.bDuplicates,=,False)
			F.Intrinsic.Control.CallSub(ProcessExisting)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.CallSub(ProcessExistingOne,"Call","First")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdProcess_Click.End

Program.Sub.ProcessNew.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Create Web Importer File and call ORDUPL to upload the Quote/Sales Order

	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.sRet3.Declare
	V.Local.sTemp.Declare
	V.Local.sFileContents.Declare
	V.Local.sFile.Declare
	V.Local.sMoveFile.Declare
	V.Local.sNumber.Declare
	V.Local.sParams.Declare
	V.Local.sSql.Declare
	V.Local.bExists.Declare
	V.Local.iRet.Declare
	V.Local.iLine.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare

	'Exit Sub if DataTable is Empty
	F.Intrinsic.Control.If(V.DataTable.dtLines.Exists,=,False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtLines.RowCount,=,0)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	Gui.frmQte.lblStatus.Caption("Uploading Data....")
	Gui.frmQte.lblStatus.Visible(True)
	
	F.Intrinsic.Control.If(V.DataTable.dtSubs.Exists)
		F.Data.DataTable.Close("dtSubs")
	F.Intrinsic.Control.EndIf
	
	'Save BOM subs and Grouping
	F.Data.DataView.Create("dtLines","dvLines")
	F.Data.DataView.ToDataTable("dtLines","dvLines","dtSubs",True)
	F.Data.DataView.Close("dtLines","dvLines")
	F.Data.DataTable.AddColumn("dtSubs","CSID",Long,0)
	F.Data.DataTable.CopyColumn("dtSubs","Group","GRPID",True)
	F.Data.DataTable.CopyColumn("dtSubs","ParentLine","PARENT_LINE",True)
	F.Data.DataTable.CopyColumn("dtSubs","ParentFlag","PARENT",True)
	F.Data.DataTable.CopyColumn("dtSubs","PartOrig","PART_ORIG",True)
	F.Data.DataTable.CopyColumn("dtSubs","Part","PART_SUB",True)
	F.Data.DataTable.CopyColumn("dtSubs","BomSeq","BOM_SEQ",True)
	F.Data.DataTable.RemoveColumn("dtSubs","Qty")
	F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY",True)
	F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY_6",True)
	F.Data.DataTable.AddColumn("dtSubs","QUOTE_NO",String)
	F.Data.DataTable.AddColumn("dtSubs","ORDER_NO",String)
	F.Data.DataTable.AddColumn("dtSubs","ORDLN",Long,0)
	F.Data.DataTable.SetSeries("dtSubs","ORDLN",1,1)
	F.Data.DataTable.RemoveColumn("dtSubs","Line")
	F.Data.DataTable.RemoveColumn("dtSubs","LineSuf")
	F.Data.DataTable.RemoveColumn("dtSubs","Group")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentLine")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentLine2")
	F.Data.DataTable.RemoveColumn("dtSubs","Customer")
	F.Data.DataTable.RemoveColumn("dtSubs","CustomerName")
	F.Data.DataTable.RemoveColumn("dtSubs","CustPO")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentFlag")
	F.Data.DataTable.RemoveColumn("dtSubs","BomSeq")
	F.Data.DataTable.RemoveColumn("dtSubs","Router")
	F.Data.DataTable.RemoveColumn("dtSubs","PartOrig")
	F.Data.DataTable.RemoveColumn("dtSubs","Part")
	F.Data.DataTable.RemoveColumn("dtSubs","Location")
	F.Data.DataTable.RemoveColumn("dtSubs","PartBrw")
	F.Data.DataTable.RemoveColumn("dtSubs","Description")
	F.Data.DataTable.RemoveColumn("dtSubs","ProdLine")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyOrig")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyOnHand")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyReq")
	F.Data.DataTable.RemoveColumn("dtSubs","DueDate")
	F.Data.DataTable.RemoveColumn("dtSubs","Pricing")
	F.Data.DataTable.SaveToDB("dtSubs","con","GAB_4812_BOM_CFGSUBS","CSID")
	F.Data.DataTable.Close("dtSubs")
	
	'Open Blank Bom DataTables
	F.Data.DataTable.CreateFromSQL("dtBomMstrOriginal","con","Select * From Bom_Mstr Where Parent = '-1';",True)
	F.Data.DataTable.CreateFromSQL("dtBomEngOriginal","con","Select * From Bom_Eng Where Part = '-1';",True)

	'Loop through dtLines and format before calling upload
	'One each element , clear sRet first, this is incase that element is not used.
	'When formatting each element of the datatable, return the final formatted element to 'v.local.sRet', it is already programmed to use that as the variable when building the file

	'REQUIRED FILEDS ARE NOTED WITH ***REQUIRED***
	'***FIELD,Length,StartPosition-Description if Available
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtLines.RowCount--,1)
		F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim)
			F.Intrinsic.Control.CaseAny("N","Y")
				F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim,=,Y)
					F.Intrinsic.String.Build("ParentLine = {0}",V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal,V.Local.sExp)
					F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
					F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
						F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
						F.Intrinsic.Control.For(V.Local.iCnt2,0,V.Local.sSelect.UBound,1)
							F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,=,"0000")
								'Bom_Mstr
								F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
								F.Data.DataTable.Merge("dtBomMstr","dtBomMstrOriginal",True,3)
								F.Data.DataTable.Close("dtBomMstr")
								F.Intrinsic.String.Build("Delete From Bom_Mstr Where Parent = '{0}' And Sequence_Bom <> '0000';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.ODBC.Connection!con.Execute(V.Local.sSql)
								'Inventory_Mstr
								F.Intrinsic.String.Build("Select * From Inventory_Mstr Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtInvBom","con",V.Local.sSql,True)
								F.Data.DataTable.SetValue("dtInvBom",-1,"Code_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Pricing!FieldVal)
								F.Data.DataTable.SaveToDB("dtInvBom","con","Inventory_Mstr","Part*!*Location")
								F.Data.DataTable.Close("dtInvBom")
							F.Intrinsic.Control.Else
								'Update BOM_MSTR
								F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}' And Sequence_Bom = '{1}' And Part = '{2}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
								F.Intrinsic.Control.If(V.DataTable.dtBomMstr.RowCount,<>,0)
									F.Data.DataTable.SetValue("dtBomMstr",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal)
								F.Intrinsic.Control.Else
									F.Intrinsic.String.Build("Select Cost From Inventory_Cost Where Part = '{0}' And Locn = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet.Set(0)
									F.Intrinsic.Control.EndIf
									F.Intrinsic.String.Build("Select UM_Inventory From Inventory_Mstr Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet2.Set(0)
									F.Intrinsic.Control.EndIf
									F.Intrinsic.String.Build("Select Code_Source From Inventory_Mst2 Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet3)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet3.Set(0)
									F.Intrinsic.Control.EndIf
									F.Data.DataTable.AddRow("dtBomMstr","Parent",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldValTrim,"Sequence_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,"Insert_Bom","00","Date_Maintenance",V.Ambient.Date.FormatMMDDYY,"Cost",V.Local.sRet.Trim,"Quantity",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Date_Start","000000","Date_Stop","000000","UM_Inventory",V.Local.sRet2.Trim,"Ordr_Usr_Flag","N","Quantity_6",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Source",V.Local.sRet3.Trim,"Frequency","0","Date_Last_Chg",V.Ambient.Date.FormatYYYYMMDD,"Time_Last_Chg","00000000","Last_Chg_By",V.Caller.User,"Last_Chg_Prog","ARC4812","Req_Trace","N","Cost_Date","00000000","Bom_Complete","Y","Inactive",False,"Chg_Rev","0","Setup_Qty","0.0000")
								F.Intrinsic.Control.EndIf
								F.Data.DataTable.SaveToDB("dtBomMstr","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom")
								F.Data.DataTable.Close("dtBomMstr")
								'Update BOM_ENG
								F.Intrinsic.String.Build("Select * From Bom_Eng Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomEng","con",V.Local.sSql,True)
								F.Data.DataTable.Merge("dtBomEng","dtBomEngOriginal",True,3)
								F.Data.DataTable.SetValue("dtBomEng",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Description",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Description!FieldVal)
								F.Data.DataTable.SaveToDB("dtBomEng","con","Bom_Eng","Part*!*Location")
								F.Data.DataTable.Close("dtBomEng")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iCnt2)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
				'Transaction, 1,1 Transaction Code:  ""O"" for sales order or ""Q"" for Quote    ***REQUIRED***
					F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
						V.Local.sTemp.Set("Q")
					F.Intrinsic.Control.Else
						V.Local.sTemp.Set("O")
					F.Intrinsic.Control.EndIf
		
				'Customer, 7,2 Customer Number: ***REQUIRED*** unless using ordupmnu to choose customer id.
					F.Intrinsic.String.RPad(V.DataTable.dtLines(V.Local.iCnt).Customer!FieldValTrim," ",7,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
		
				'OrderNo, 7,9 If AutoNumbering Turned on can be left blank, otherwise a required field with leading zeros
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",15,V.Local.sTemp)
		
				'Freight,10,16 Freight amount  8.2  Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50     0000000250
					V.Local.sRet.Set("")
'					F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.i)!Freight,"0.00",v.uGlobal.uOrders(v.Local.i)!Freight)
'					F.Intrinsic.String.Replace(v.uGlobal.uOrders(v.Local.i)!Freight,".","",v.uGlobal.uOrders(v.Local.i)!Freight)
'					F.Intrinsic.String.LPad(v.uGlobal.uOrders(v.Local.i)!Freight,"0",10,v.Local.sRet)
					F.Intrinsic.String.LPad("","0",10,v.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",25,V.Local.sTemp)
		
				'Tax Freight Flag,1,26 Flag Y N or blank
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",26,V.Local.sTemp)
		
				'Freight Per Piece,1,27 Flag Y N or blank
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",27,V.Local.sTemp)
		
				'Order Date Due,8,28 CCYYMMDD   Example entry of Aug 5 2006     20060806
					V.Local.sRet.Set("")
					F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",35,V.Local.sTemp)
		
				'Order Date,8,36 CCYYMMDD   Example entry of Aug 5 2006     20060806
					V.Local.sRet.Set("")
					F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",43,V.Local.sTemp)
		
				'User 1 Header,30,44 User Field for Header up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",73,V.Local.sTemp)
		
				'User Field 2 Header,30,74 User Field for Header up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",103,V.Local.sTemp)
		
				'User Field 3 Header,30,104 User Field for Header up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",133,V.Local.sTemp)
		
				'User Field 4 Header,30,134 User Field for Header up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",163,V.Local.sTemp)
		
				'User Field 5 Header,30,164 User Field for Header up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",193,V.Local.sTemp)
		
				'UserId,8,194 User Field for Header up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",201,V.Local.sTemp)
		
				'CustomerPO,15,202 User Field for Header up to 30 characters
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).CustPO!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",231,V.Local.sTemp)
		
				'Filler_1,15,217,Not Used- Leave Blank
		
				'Freight_CurrFlag,1,232,Y N or blank
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",232,V.Local.sTemp)
		
				'Data Type,1,233,"""S"" for shipping data"
					V.Local.sRet.Set("S")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",233,V.Local.sTemp)
		
				'Ship Via,20,234
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",253,V.Local.sTemp)
		
				'Carrier,6,254
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",259,V.Local.sTemp)
		
				'Ship To Name,30,260
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",289,V.Local.sTemp)
		
				'Ship To Address 1,30,290
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",319,V.Local.sTemp)
		
				'Ship To Address 2,30,320
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",349,V.Local.sTemp)
		
				'Ship To Address 3,30,350
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",379,V.Local.sTemp)
		
				'Ship To City,25,380
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",404,V.Local.sTemp)
		
				'Ship To State,2,405
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",406,V.Local.sTemp)
		
				'Ship To Zip,13,407
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",419,V.Local.sTemp)
		
				'Ship To Country,3,420
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",422,V.Local.sTemp)
		
				'ShipToAttention,30,423
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",463,V.Local.sTemp)
		
				'filler in reusable area,11,453,Not in Use
		
				'Order type,1,464,"Regular = blank or spaces, Invoice = ""X"
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",464,V.Local.sTemp)
		
				'Order Discount Percentage,5,465,1.4 with an implied decimal (example:  45% would show as 04500 in the file
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",469,V.Local.sTemp)
		
				'Salesman,3,470,Salesman code within GSS
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",472,V.Local.sTemp)
		
				'PAY-METHOD , 2,473
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",474,V.Local.sTemp)
		
				'PAY-OWNER-NAME,30,475
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",504,V.Local.sTemp)
		
				'PAY-CC-TYPE ,2,505
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",506,V.Local.sTemp)
		
				'PAY-CC-NO , 25,507
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",531,V.Local.sTemp)
		
				'PAY-CC-LENGTH , 2,532
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",533,V.Local.sTemp)
		
				'PAY-CC-EXP-DT , 6,534
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",539,V.Local.sTemp)
		
				'PAY-CC-CVV , 7, 540
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",546,V.Local.sTemp)
		
				'PAY-CVV-LENGTH 1, 547 Numeric(1 or 0)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",547,V.Local.sTemp)
		
				'Override auto numbering,1,548,"Populate with ""1"" will override the auto ordering number with the number provided in the order number above
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",548,V.Local.sTemp)
		
				'Ship To Id,6,549,"Optional, must be valid for customer
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",554,V.Local.sTemp)
		
				'Mark Shipment,30,555
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",584,V.Local.sTemp)
		
				'Contact Name,30,585
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",614,V.Local.sTemp)
		
				'From Location, 2,615
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",701,V.Local.sTemp)
		
				'Filler_3,85,617,Not in Use
		
'************************************************************************************Line Data************************************************************************************
				'Line Number,3,702,Not ***REQUIRED*** Valid input is 1 through 999
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Line!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet.Format#,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",705,V.Local.sTemp)
		
				'Filler_Line,1,705,Not Used- Leave Blank
		
				'Qty Ordered,13,706,9.4; REQUIRED  Must enter numeric values with a filler or zeroes- do not enter spaces.  Example entry of 10  0000000100000
					V.Local.sRet.Set("")
					F.Intrinsic.String.Format(V.DataTable.dtLines(V.Local.iCnt).Qty!FieldVal,"0.0000",V.Local.sRet)
					F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",13,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",718,V.Local.sTemp)
		
				'Weight,10,719,7.3 Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50 would be 0000002500
					V.Local.sRet.Set("")
					'F.Intrinsic.String.Format(V.DataTable.dtLines(V.Local.iCnt).TotWeight!FieldVal,"0.000",V.Local.sRet)
					F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",10,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",728,V.Local.sTemp)
		
				'Unit Of Measure,2,729,Unit of Measure
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).UM!FieldValTrim)
					F.Intrinsic.String.RPad(V.Local.sRet," ",2,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",730,V.Local.sTemp)
		
				'*** 20 Char Part# - PART, 20,731***REQUIRED***
				'Part Number,17,731,17 character part number
				'Part Rev,3,748,***REQUIRED*** if using part rev and a revision exists OR if NOT using part revision and part is longer than 17 characters long.
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Part!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",768,V.Local.sTemp)
		
				'Filler,18,751,Not in Use - Leave Blank
		
				'Part Location,2,769,Location code
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Location!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",770,V.Local.sTemp)
		
				'Quoted Price,16,771,10.6; REQUIRED in company currency.
				'Make sure to fill in discount price even if no discounts apply.
				'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
					V.Local.sRet.Set("")
					F.Intrinsic.String.Replace(v.Local.sRet,".","",v.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",786,V.Local.sTemp)
		
				'OverRidePrice,16,787,10.6; any price over-rides in company currency.
				'Make sure to fill in discount price even if no discounts apply.
				'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",802,V.Local.sTemp)
		
				'Cost,16,803,10.6; Cost of the Part in company currency.
				'Enter leading zeros - do not enter spaces.   Example of 12.50  00000012500000
					V.Local.sRet.Set("")
'					F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.i)!Cost,"0.000000",v.uGlobal.uOrders(v.Local.i)!Cost)
'					F.Intrinsic.String.Replace(v.uGlobal.uOrders(v.Local.i)!Cost,".","",v.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",818,V.Local.sTemp)
		
				'DescriptionPart,30,819,Description of the Part Number Length of 30
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Description!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",848,V.Local.sTemp)
		
				'Product Line,3,849,Product Line of part number
'					V.Local.sRet.Set(v.uGlobal.uOrders(v.Local.i)!PL)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",851,V.Local.sTemp)
		
				'Line Order Date,8,852,CCYYMMDD  Example entry of Aug 5 2006     20060806
					V.Local.sRet.Set("")
					F.Intrinsic.String.Format(v.Ambient.Date,"YYYYMMDD",v.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",859,V.Local.sTemp)
		
				'Line Promise Date,8,860,CCYYMMDD  Example entry of Aug 5 2006     20060806
				V.Local.sRet.Set("")
'				F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.iOrder)!DateDue_Order,"YYYYMMDD",v.Local.sRet)
				F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",v.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",867,V.Local.sTemp)
		
				'User Field 1,30,868,User Field forLine up to 30 characters
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Group!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",897,V.Local.sTemp)
		
				'User Field 2,30,898,User Field forLine up to 30 characters
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",927,V.Local.sTemp)
		
				'User Field 3,30,928,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",957,V.Local.sTemp)
		
				'User Field 4,30,958,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",987,V.Local.sTemp)
		
				'User Field 5,30,988,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1017,V.Local.sTemp)
		
				'Extention,16,1018,"10.6 in company currency.
				'Leading zeros - no spaces or commas.  Example of 1,250.21  0000001250210000
					V.Local.sRet.Set("")
'					F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.i)!Extention,"0.000000",v.uGlobal.uOrders(v.Local.i)!Extention)
'					F.Intrinsic.String.Replace(v.uGlobal.uOrders(v.Local.i)!Extention,".","",v.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1033,V.Local.sTemp)
		
				'No Delivery Before Date,8,1034,CCYYMMDD  Example entry of Aug 5 2006     20060806
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1041,V.Local.sTemp)
		
				'Must Deliver By Date,8,1042,CCYYMMDD  Example entry of Aug 5 2006     20060806
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1049,V.Local.sTemp)
		
				'vvv EXTRA TEXT vvv
		
				'DataType,1,1050,"""T"" for sales order text
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,"",V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1050,V.Local.sTemp)
		
				'Text Line 1,30,1051,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE1.Trim)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1080,V.Local.sTemp)
		
				'Text Line 2,30,1081,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE2.Trim)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1110,V.Local.sTemp)
		
				'Text Line 3,30,1111,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE3.Trim)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1140,V.Local.sTemp)
		
				'Text Line 4,30,1141,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE4.Trim)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1170,V.Local.sTemp)
		
				'Text Line 5,30,1171,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE5.Trim)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1200,V.Local.sTemp)
		
				'Text Line 6,30,1201,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1230,V.Local.sTemp)
		
				'Text Line 7,30,1231,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1260,V.Local.sTemp)
		
				'Text Line 8,30,1261,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1290,V.Local.sTemp)
		
				'Text Line 9,30,1291,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1320,V.Local.sTemp)
		
				'Text Line 10,30,1321,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1350,V.Local.sTemp)
		
				'Tax Status Flag,1,1351,"""E"" for exempt, ""T"" for taxable
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1351,V.Local.sTemp)
		
				'Line Type,1,1352,"""B"" for buyout, ""D"" for dropship, ""S"" for standard, ""C"" for consignment
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1352,V.Local.sTemp)
		
				'Negative Flag,1,1353,"""1"" = The order qty is negative for this line."
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1353,V.Local.sTemp)
		
				'Price Flag,1,1354,"""1"" = Accept zero price for this line.
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1354,V.Local.sTemp)
		
				'Sufficient Inventory Check,1,1355,"""1"" = Check to make sure inventory level is sufficient for this line.
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1355,V.Local.sTemp)
		
				'Survey No ,8,1356
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1363,V.Local.sTemp)
		
				'Router Val Flag 1,1364
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1364,V.Local.sTemp)
		
				'Router , 20,1365
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1384,V.Local.sTemp)
		
				'Router Seq ,6,1385
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1390,V.Local.sTemp)
		
				'STOCK-XREF, 1,1391
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1391,V.Local.sTemp)
		
				'Origin Order ,7,1392
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1398,V.Local.sTemp)
		
				'Origin Line,3,1399
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1401,V.Local.sTemp)
		
				'Length ,12,1402 Numeric(8,4)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1413,V.Local.sTemp)
		
				'WIDTH ,12,1414 Numeric(8,4)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1425,V.Local.sTemp)
		
				'CURR-FLAG ,1,1426
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1426,V.Local.sTemp)
		
				'Order Discount Percentage,5,1427,Order Line Discount format.
				'The field contains 1 leading digit and four decimals.  So 00500 would be entered for a 5% discount.
					V.Local.sRet.Set("")
'					F.Intrinsic.Control.If(V.uGlobal.uOrders(v.Local.i)!Order_Disc_Pct.Trim,<>,"")
'						F.Intrinsic.String.Split(V.uGlobal.uOrders(v.Local.i)!Order_Disc_Pct,".",V.Local.sRet)
'						F.Intrinsic.String.RPad(V.Local.sRet(1),"0",4,V.Local.sRet)
'					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.LPad(V.Local.sRet,"0",5,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1517,V.Local.sTemp)
		
				'Filler,86,1432,Not in Use - Leave Blank
		
'************************************************************************************Extended Header Data************************************************************************************
				'Ship To International Flag,1,1518,"""Y"" for international address, ""N"" or spaces for domestic address
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1518,V.Local.sTemp)
		
				'Ship To Name,40,1519
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1558,V.Local.sTemp)
		
				'Ship To Address 1,40,1559
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1598,V.Local.sTemp)
		
				'Ship To Address 2,40,1599
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1638,V.Local.sTemp)
		
				'Ship To Address 3,40,1639
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1678,V.Local.sTemp)
		
				'Ship To Address 4,40,1679
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1718,V.Local.sTemp)
		
				'Ship To Address 5,40,1719
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1758,V.Local.sTemp)
		
				'Ship To City,25,1759
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1783,V.Local.sTemp)
		
				'Ship To State,2,1784
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1785,V.Local.sTemp)
		
				'Ship To Zip,13,1786
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1798,V.Local.sTemp)
		
				'Ship To Country,25,1799
						V.Local.sRet.Set("")
						F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
						F.Intrinsic.String.RPad(V.Local.sTemp," ",1823,V.Local.sTemp)
		
				'Ship To Attention,40,1824
						V.Local.sRet.Set("")
						F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
						F.Intrinsic.String.RPad(V.Local.sTemp," ",1863,V.Local.sTemp)
		
'************************************************************************************Bill To Data************************************************************************************
				'Bill To International Flag,1,1864,"""Y"" for international address, ""N"" or spaces for domestic address
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1864,V.Local.sTemp)
		
				'Bill To Name,40,1865
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1904,V.Local.sTemp)
		
				'Bill To Address 1,40,1905
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1943,V.Local.sTemp)
		
				'Bill To Address 2,40,1945
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1984,V.Local.sTemp)
		
				'Bill To Address 3,40,1985
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2024,V.Local.sTemp)
		
				'Bill To Address 4,40,2025
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2064,V.Local.sTemp)
		
				'Bill To Address 5,40,2065
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2104,V.Local.sTemp)
		
				'Bill To City,25,2105
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2129,V.Local.sTemp)
		
				'Bill To State,2,2130
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2131,V.Local.sTemp)
		
				'Bill To Zip,13,2132
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2144,V.Local.sTemp)
		
				'Bill To Country,25,2145
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2169,V.Local.sTemp)
		
				'Bill To Attention,40,2170
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2209,V.Local.sTemp)
		
				'Contact's Email Address,100,2210
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2309,V.Local.sTemp)
		
				'Contact's Phone,20,2310
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2329,V.Local.sTemp)
		
'************************************************************************************Sales Order Header Text Data************************************************************************************
				'Text Line 1,30,2330,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2359,V.Local.sTemp)
		
				'Text Line 2,30,2360,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2389,V.Local.sTemp)
		
				'Text Line 3,30,2390,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2419,V.Local.sTemp)
		
				'Text Line 4,30,2420,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2449,V.Local.sTemp)
		
				'Text Line 5,30,2450,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2479,V.Local.sTemp)
		
				'Text Line 6,30,2480,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2509,V.Local.sTemp)
		
				'Text Line 7,30,2510,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2539,V.Local.sTemp)
		
				'Text Line 8,30,2540,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2569,V.Local.sTemp)
		
				'Text Line 9,30,2570,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2599,V.Local.sTemp)
		
				'Text Line 10,30,2600,Additional Text for Line up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2629,V.Local.sTemp)
		
				'Text Position,1,2630,"""H"" for header, ""F"" for footer
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2630,V.Local.sTemp)
		
				'Apply Text to Sales Order,1,2631,"""Y"" to apply, ""N"" for do not apply
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2631,V.Local.sTemp)
		
				'Apply Text to Packing List,1,2632,"""Y"" to apply, ""N"" for do not apply
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2632,V.Local.sTemp)
		
				'Apply Text to Invoice,1,2633,"""Y"" to apply, ""N"" for do not apply
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2633,V.Local.sTemp)
		
				'Apply Text to Quote,1,2634,"""Y"" to apply, ""N"" for do not apply
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2634,V.Local.sTemp)
		
				'Apply Text to Router,1,2635,"""Y"" to apply, ""N"" for do not apply
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2636,V.Local.sTemp)
		
				'Apply Text to Work Order,1,2636,"""Y"" to apply, ""N"" for do not apply
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",2637,V.Local.sTemp)
		
				'Filler,1000,2637,Not in Use - Leave Blank
		
				'Filler,1000,3637,Not in Use - Leave Blank
		
				'***Total Record length of,4565 if all used
		
				'Build File Contents in Separate Temp Var
				F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sFileContents,V.Local.sTemp,V.Ambient.NewLine,V.Local.sFileContents)
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Next(V.Local.iCnt)

	'Create Web_Order Directories
	F.Intrinsic.String.Build("{0}\WEB_ORDERS",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\CONVERTED",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\WEB_ERRORS",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)

	'String to File containing sFileContents to V.Local.sFile
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED\{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sMoveFile)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sFileContents)
	V.Local.sFileContents.Set("")

	'Call Upload Web Importer ORDUPL (File: GSSPARAM.txt)
	F.Global.General.CallWrapperSync(50,"ORDUPL")
	Gui.frmQte.lblStatus.Caption("Upload Complete")
	
	'Move file if not moved already
	F.Intrinsic.Control.If(V.Local.sNumber,<>,"")
		F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bExists)
		F.Intrinsic.Control.If(V.Local.bExists)
			F.Intrinsic.File.MoveFile(V.Local.sFile,V.Local.sMoveFile,V.Local.iRet)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	'Get last Quote/Sales Order number uploaded
	F.Intrinsic.String.Build("Select * From GAB_4812_BOM_CFGSUBS Where RanKey = {0};",V.Global.iRanKey,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("dtSubs","con",V.Local.sSql,True)
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		F.Intrinsic.String.Build("Select Top 1 Quote_No From V_Quote_Header Where Date_Quote = '{0}' And Last_Chg_By = '{1}' And Last_Chg_Pgm = 'ORDUP3' Order By Quote_No Desc;",V.Ambient.Date.PervasiveDate,V.Caller.User,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sNumber)
		'Update Quote in Sub Table
		F.Data.DataTable.SetValue("dtSubs",-1,"QUOTE_NO",V.Local.sNumber)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("Select Top 1 Order_No From V_Order_Header Where Date_Order = '{0}' And Last_Chg_By = '{1}' And Last_Chg_Pgm = 'ORDUP3' Order By Order_No Desc;",V.Ambient.Date.PervasiveDate,V.Caller.User,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sNumber)
		'Update Order in Sub Table
		F.Data.DataTable.SetValue("dtSubs",-1,"ORDER_NO",V.Local.sNumber)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.SaveToDB("dtSubs","con","GAB_4812_BOM_CFGSUBS","CSID")
	F.Data.DataTable.Close("dtSubs")
	
	'Create WOs if Sales Orders are created
	F.Intrinsic.Control.If(V.Screen.frmQte!optOrd.Value)
	F.Intrinsic.Control.AndIf(V.Screen.frmQte!chkAutoWO.Value,=,1)
		Gui.frmQte.lblStatus.Caption("Scheduling Work Orders....")
		F.Intrinsic.String.Build("Select A.Order_No,A.Record_No From V_Order_Lines A Left Join V_Inventory_Mst2 B On A.Part = B.Part And A.Location = B.Location Where Order_No = '{0}' And A.Date_Last_Chg = '{1}' And A.Last_Chg_By = '{2}' And A.Last_Chg_Pgm In ('ORDUP3','ORD0BMGI') And B.Code_Source In ('M','F') And A.Flag_Bom = 'Y' Order By A.Date_Last_Chg Desc,Record_No;",V.Local.sNumber,V.Ambient.Date.PervasiveDate,V.Caller.User,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("dtRecords","con",V.Local.sSql,True)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtRecords.RowCount--,1)
			F.Intrinsic.String.ConcatCallWrapperArgs("O",V.DataTable.dtRecords(V.Local.iCnt).Order_No!FieldValTrim,V.DataTable.dtRecords(V.Local.iCnt).Record_No!FieldValTrim,"1","1",V.Local.sParams)
			F.Global.General.CallWrapperSync(200802,V.Local.sParams)
		F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Data.DataTable.Close("dtRecords")
	F.Intrinsic.Control.EndIf
	
	'Put Original BOM back
	Gui.frmQte.lblStatus.Caption("Saving Original BOMs....")
	F.Data.DataTable.Select("dtBomMstrOriginal","Sequence_Bom = '0000'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			F.Intrinsic.String.Build("Delete From Bom_Mstr Where Parent = '{0}';",V.DataTable.dtBomMstrOriginal(V.Local.sSelect(V.Local.iCnt).Long).Parent!FieldVal,V.Local.sSql)
			F.ODBC.Connection!con.Execute(V.Local.sSql)
		F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Data.DataTable.SaveToDB("dtBomMstrOriginal","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom",256)
		F.Data.DataTable.SaveToDB("dtBomEngOriginal","con","Bom_Eng","Part*!*Location",256)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.Close("dtBomMstrOriginal")
	F.Data.DataTable.Close("dtBomEngOriginal")
	
	'Call Core Screen to display Quote or Sales Order
	F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sNumber,"O","*!*ZDR*!*",V.Local.sParams)
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		'Launch Quote
		Gui.frmQte.lblStatus.Caption("Launching Quote....")
		F.Global.General.CallWrapperSync(251000,V.Local.sParams)
	F.Intrinsic.Control.Else
		'Launch Sales Order
		Gui.frmQte.lblStatus.Caption("Launching Sales Order....")
		F.Global.General.CallWrapperSync(200000,v.Local.sParams)
	F.Intrinsic.Control.EndIf

	Gui.frmQte.cboCust.Text("")
	Gui.frmQte.cboCustName.Text("")
	Gui.frmQte.txtCustPO.Text("")
	Gui.frmQte.optTopLevel.Value(True)
	Gui.frmQte.chkAutoWO.Value(0)
	F.Data.DataTable.DeleteRow("dtLines")
	Gui.frmComments.txtGroup.Text("")
	Gui.frmComments.txtComments.Text("")
	F.Intrinsic.Control.If(V.DataTable.dtComments.Exists)
		F.Data.DataTable.DeleteRow("dtComments")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(GenerateKey)
	F.Intrinsic.Control.CallSub(Clear)
	Gui.frmQte.lblStatus.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ProcessNew.End

Program.Sub.ProcessExisting.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Create Web Importer File and call ORDUPL to upload the Quote/Sales Order

	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.sRet3.Declare
	V.Local.sTemp.Declare
	V.Local.sFileContents.Declare
	V.Local.sFile.Declare
	V.Local.sMoveFile.Declare
	V.Local.sNumber.Declare
	V.Local.sParams.Declare
	V.Local.sSql.Declare
	V.Local.bExists.Declare
	V.Local.iRet.Declare
	V.Local.iLine.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare

	'Exit Sub if DataTable is Empty
	F.Intrinsic.Control.If(V.DataTable.dtLines.Exists,=,False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtLines.RowCount,=,0)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	Gui.frmQte.lblStatus.Caption("Uploading Data....")
	Gui.frmQte.lblStatus.Visible(True)
	
	F.Intrinsic.Control.If(V.DataTable.dtSubs.Exists)
		F.Data.DataTable.Close("dtSubs")
	F.Intrinsic.Control.EndIf
	
	'Save BOM subs and Grouping
	F.Data.DataView.Create("dtLines","dvLines")
	F.Data.DataView.ToDataTable("dtLines","dvLines","dtSubs",True)
	F.Data.DataView.Close("dtLines","dvLines")
	F.Data.DataTable.AddColumn("dtSubs","CSID",Long,0)
	F.Data.DataTable.CopyColumn("dtSubs","Group","GRPID",True)
	F.Data.DataTable.CopyColumn("dtSubs","ParentLine","PARENT_LINE",True)
	F.Data.DataTable.CopyColumn("dtSubs","ParentFlag","PARENT",True)
	F.Data.DataTable.CopyColumn("dtSubs","PartOrig","PART_ORIG",True)
	F.Data.DataTable.CopyColumn("dtSubs","Part","PART_SUB",True)
	F.Data.DataTable.RemoveColumn("dtSubs","Qty")
	F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY",True)
	F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY_6",True)
	F.Data.DataTable.AddColumn("dtSubs","QUOTE_NO",String)
	F.Data.DataTable.AddColumn("dtSubs","ORDER_NO",String)
	F.Data.DataTable.AddColumn("dtSubs","ORDLN",Long,0)
	F.Data.DataTable.SetSeries("dtSubs","ORDLN",1,1)
	F.Data.DataTable.RemoveColumn("dtSubs","Line")
	F.Data.DataTable.RemoveColumn("dtSubs","LineSuf")
	F.Data.DataTable.RemoveColumn("dtSubs","Group")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentLine")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentLine2")
	F.Data.DataTable.RemoveColumn("dtSubs","Customer")
	F.Data.DataTable.RemoveColumn("dtSubs","CustomerName")
	F.Data.DataTable.RemoveColumn("dtSubs","CustPO")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentFlag")
	F.Data.DataTable.RemoveColumn("dtSubs","BomSeq")
	F.Data.DataTable.RemoveColumn("dtSubs","Router")
	F.Data.DataTable.RemoveColumn("dtSubs","PartOrig")
	F.Data.DataTable.RemoveColumn("dtSubs","Part")
	F.Data.DataTable.RemoveColumn("dtSubs","Location")
	F.Data.DataTable.RemoveColumn("dtSubs","PartBrw")
	F.Data.DataTable.RemoveColumn("dtSubs","Description")
	F.Data.DataTable.RemoveColumn("dtSubs","ProdLine")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyOrig")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyOnHand")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyReq")
	F.Data.DataTable.RemoveColumn("dtSubs","DueDate")
	F.Data.DataTable.RemoveColumn("dtSubs","Pricing")
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		'Update Quote in Sub Table
		F.Data.DataTable.SetValue("dtSubs",-1,"QUOTE_NO",V.Screen.frmQte!txtQuote.Text)
	F.Intrinsic.Control.Else
		'Update Order in Sub Table
		F.Data.DataTable.SetValue("dtSubs",-1,"ORDER_NO",V.Screen.frmQte!txtQuote.Text)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.SaveToDB("dtSubs","con","GAB_4812_BOM_CFGSUBS","CSID")
	F.Data.DataTable.Close("dtSubs")
	
	'Open Blank Bom DataTables
	F.Data.DataTable.CreateFromSQL("dtBomMstrOriginal","con","Select * From Bom_Mstr Where Parent = '-1';",True)
	F.Data.DataTable.CreateFromSQL("dtBomEngOriginal","con","Select * From Bom_Eng Where Part = '-1';",True)

	'Loop through dtLines and format before calling upload
	'One each element , clear sRet first, this is incase that element is not used.
	'When formatting each element of the datatable, return the final formatted element to 'v.local.sRet', it is already programmed to use that as the variable when building the file

	'REQUIRED FILEDS ARE NOTED WITH ***REQUIRED***
	'***FIELD,Length,StartPosition-Description if Available

	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtLines.RowCount--,1)
		F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim)
			F.Intrinsic.Control.CaseAny("N","Y")
				F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim,=,Y)
					F.Intrinsic.String.Build("ParentLine = {0}",V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal,V.Local.sExp)
					F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
					F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
						F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
						F.Intrinsic.Control.For(V.Local.iCnt2,0,V.Local.sSelect.UBound,1)
							F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,=,"0000")
								'Bom_Mstr
'								F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}' And Sequence_Bom = '0000';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
								F.Data.DataTable.Merge("dtBomMstr","dtBomMstrOriginal",True,3)
								F.Data.DataTable.Close("dtBomMstr")
								F.Intrinsic.String.Build("Delete From Bom_Mstr Where Parent = '{0}' And Sequence_Bom <> '0000';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.ODBC.Connection!con.Execute(V.Local.sSql)
								'Inventory_Mstr
								F.Intrinsic.String.Build("Select * From Inventory_Mstr Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtInvBom","con",V.Local.sSql,True)
								F.Data.DataTable.SetValue("dtInvBom",-1,"Code_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Pricing!FieldVal)
								F.Data.DataTable.SaveToDB("dtInvBom","con","Inventory_Mstr","Part*!*Location")
								F.Data.DataTable.Close("dtInvBom")
							F.Intrinsic.Control.Else
								'Update BOM_MSTR
								F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}' And Sequence_Bom = '{1}' And Part = '{2}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
								F.Intrinsic.Control.If(V.DataTable.dtBomMstr.RowCount,<>,0)
'									F.Data.DataTable.Merge("dtBomMstr","dtBomMstrOriginal",True,3)
									F.Data.DataTable.SetValue("dtBomMstr",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal)
								F.Intrinsic.Control.Else
									F.Intrinsic.String.Build("Select Cost From Inventory_Cost Where Part = '{0}' And Locn = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet.Set(0)
									F.Intrinsic.Control.EndIf
									F.Intrinsic.String.Build("Select UM_Inventory From Inventory_Mstr Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet2.Set(0)
									F.Intrinsic.Control.EndIf
									F.Intrinsic.String.Build("Select Code_Source From Inventory_Mst2 Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet3)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet3.Set(0)
									F.Intrinsic.Control.EndIf
									F.Data.DataTable.AddRow("dtBomMstr","Parent",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldValTrim,"Sequence_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,"Insert_Bom","00","Date_Maintenance",V.Ambient.Date.FormatMMDDYY,"Cost",V.Local.sRet.Trim,"Quantity",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Date_Start","000000","Date_Stop","000000","UM_Inventory",V.Local.sRet2.Trim,"Ordr_Usr_Flag","N","Quantity_6",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Source",V.Local.sRet3.Trim,"Frequency","0","Date_Last_Chg",V.Ambient.Date.FormatYYYYMMDD,"Time_Last_Chg","00000000","Last_Chg_By",V.Caller.User,"Last_Chg_Prog","ARC4812","Req_Trace","N","Cost_Date","00000000","Bom_Complete","Y","Inactive",False,"Chg_Rev","0","Setup_Qty","0.0000")
								F.Intrinsic.Control.EndIf
								F.Data.DataTable.SaveToDB("dtBomMstr","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom")
								F.Data.DataTable.Close("dtBomMstr")
								'Update BOM_ENG
								F.Intrinsic.String.Build("Select * From Bom_Eng Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomEng","con",V.Local.sSql,True)
								F.Data.DataTable.Merge("dtBomEng","dtBomEngOriginal",True,3)
								F.Data.DataTable.SetValue("dtBomEng",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Description",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Description!FieldVal)
								F.Data.DataTable.SaveToDB("dtBomEng","con","Bom_Eng","Part*!*Location")
								F.Data.DataTable.Close("dtBomEng")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iCnt2)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
				'Transaction, 1,1 Transaction Code:  ""O"" for sales order or ""Q"" for Quote    ***REQUIRED***
					F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
						V.Local.sTemp.Set("Q")
					F.Intrinsic.Control.Else
						V.Local.sTemp.Set("O")
					F.Intrinsic.Control.EndIf
		
				'Customer, 7,2 Customer Number: ***REQUIRED*** unless using ordupmnu to choose customer id.
					F.Intrinsic.String.RPad(V.DataTable.dtLines(V.Local.iCnt).Customer!FieldValTrim," ",7,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
		
				'OrderNo, 7,9 If AutoNumbering Turned on can be left blank, otherwise a required field with leading zeros
					V.Local.sRet.Set("")
					F.Intrinsic.String.LPad(V.Screen.frmQte!txtQuote.Text,"0",7,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",15,V.Local.sTemp)
					
				'*** 20 Char Part# - PART, 20,16***REQUIRED***
				'Part Number,17,16,17 character part number
				'Part Rev,3,33,***REQUIRED*** if using part rev and a revision exists OR if NOT using part revision and part is longer than 17 characters long.
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Part!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",53,V.Local.sTemp)
		
				'Filler,18,36,Not in Use - Leave Blank
		
				'Part Location,2,54,Location code
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Location!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",55,V.Local.sTemp)
					
				'Product Line,5,56,Product Line of part number
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",61,V.Local.sTemp)
					
				'DescriptionPart,30,61,Description of the Part Number Length of 30
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Description!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",90,V.Local.sTemp)
					
				'Line Number,3,91,Not ***REQUIRED*** Valid input is 1 through 999
'					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Line!FieldValTrim)
					V.Local.sRet.Set("000")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",93,V.Local.sTemp)
					
				'Line Type,1,94,Line Type up to 1 character
					V.Local.sRet.Set("S")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",94,V.Local.sTemp)
					
				'Qty Ordered,13,95,9.4; REQUIRED  Must enter numeric values with a filler or zeroes- do not enter spaces.  Example entry of 10  0000000100000
					V.Local.sRet.Set("")
					F.Intrinsic.String.Format(V.DataTable.dtLines(V.Local.iCnt).Qty!FieldVal,"0.0000",V.Local.sRet)
					F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",13,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",107,V.Local.sTemp)
					
				'Weight,10,108,7.3 Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50 would be 0000002500
					V.Local.sRet.Set("")
					F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",10,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",117,V.Local.sTemp)
					
				'Quoted Price,16,118,10.6; REQUIRED in company currency.
				'Make sure to fill in discount price even if no discounts apply.
				'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
					V.Local.sRet.Set("")
					F.Intrinsic.String.Replace(v.Local.sRet,".","",v.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",133,V.Local.sTemp)
					
				'User Field 1,30,134,User Field forLine up to 30 characters
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Group!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",163,V.Local.sTemp)
		
				'User Field 2,30,164,User Field forLine up to 30 characters
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",193,V.Local.sTemp)
		
				'User Field 3,30,194,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",223,V.Local.sTemp)
		
				'User Field 4,30,224,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",253,V.Local.sTemp)
		
				'User Field 5,30,254,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",283,V.Local.sTemp)
					
				'Unit Of Measure,2,284,Unit of Measure
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).UM!FieldValTrim)
					F.Intrinsic.String.RPad(V.Local.sRet," ",2,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",285,V.Local.sTemp)
					
				'Price Flag,1,286,"""1"" = Accept zero price for this line.
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",286,V.Local.sTemp)
		
				'Survey No ,8,287
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",294,V.Local.sTemp)
		
				'Router Val Flag 1,295
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",295,V.Local.sTemp)
		
				'Length ,12,296 Numeric(8,4)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",307,V.Local.sTemp)
		
				'Width ,12,308 Numeric(8,4)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",319,V.Local.sTemp)
					
				'Cost Flag,1,320,1 = Accept Cost Override
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",320,V.Local.sTemp)
					
				'Cost,16,321,10.6; Cost of the Part in company currency.
				'Enter leading zeros - do not enter spaces.   Example of 12.50  00000012500000
					V.Local.sRet.Set("")
					F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",336,V.Local.sTemp)
					
				'Tax Override Flag,1,337,1 = Accept Tax Override
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",337,V.Local.sTemp)
					
				'Tax Flag,1,338,"""E"" for exempt, ""T"" for taxable
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",339,V.Local.sTemp)
					
				'Filler,45,339,Not Used- Leave Blank
					
				'***Total Record length of 339 if all used
		
				'Build File Contents in Separate Temp Var
				F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sFileContents,V.Local.sTemp,V.Ambient.NewLine,V.Local.sFileContents)
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Next(V.Local.iCnt)

	'Create Web_Order Directories
	F.Intrinsic.String.Build("{0}\WEB_ORDERS",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\CONVERTED",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\WEB_ERRORS",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)

	'String to File containing sFileContents to V.Local.sFile
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\LNADD{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED\LNADD{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sMoveFile)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sFileContents)
	V.Local.sFileContents.Set("")

	'CallWrapper 7020 (ORDADLN) (File: GSSPARAM.txt)
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		F.Intrinsic.String.ConcatCallWrapperArgs(V.Screen.frmQte!txtQuote.Text,"Q",V.Local.sFile,V.Local.sParams)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.ConcatCallWrapperArgs(V.Screen.frmQte!txtQuote.Text,"O",V.Local.sFile,V.Local.sParams)
	F.Intrinsic.Control.EndIf
	F.Global.General.CallWrapperSync(7020,V.Local.sParams)
	Gui.frmQte.lblStatus.Caption("Upload Complete")
	
	'Move file if not moved already
	F.Intrinsic.Control.If(V.Screen.frmQte!txtQuote.Text,<>,"")
		F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bExists)
		F.Intrinsic.Control.If(V.Local.bExists)
			F.Intrinsic.File.MoveFile(V.Local.sFile,V.Local.sMoveFile,V.Local.iRet)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	'Create WOs if Sales Order Lines are added
	F.Intrinsic.Control.If(V.Screen.frmQte!optOrd.Value)
	F.Intrinsic.Control.AndIf(V.Screen.frmQte!chkAutoWO.Value,=,1)
		Gui.frmQte.lblStatus.Caption("Scheduling Work Orders....")
		F.Intrinsic.String.Build("Select A.Order_No,A.Record_No From V_Order_Lines A Left Join V_Inventory_Mst2 B On A.Part = B.Part And A.Location = B.Location Where Order_No = '{0}' And A.Date_Last_Chg = '{1}' And A.Last_Chg_By = '{2}' And A.Last_Chg_Pgm In ('ORDADLN','ORD0BMGI') And B.Code_Source In ('M','F') And A.Flag_SO_To_WO = '' Order By A.Date_Last_Chg Desc,Record_No;",V.Screen.frmQte!txtQuote.Text,V.Ambient.Date.PervasiveDate,V.Caller.User,V.Local.sSql)
		F.Data.DataTable.CreateFromSQL("dtRecords","con",V.Local.sSql,True)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtRecords.RowCount--,1)
			F.Intrinsic.String.ConcatCallWrapperArgs("O",V.Screen.frmQte!txtQuote.Text,V.DataTable.dtRecords(V.Local.iCnt).Record_No!FieldValTrim,"1","1",V.Local.sParams)
			F.Global.General.CallWrapperSync(200802,V.Local.sParams)
		F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Data.DataTable.Close("dtRecords")
	F.Intrinsic.Control.EndIf
	
	'Put Original BOM back
	Gui.frmQte.lblStatus.Caption("Saving Original BOMs....")
	F.Data.DataTable.SaveToDB("dtBomMstrOriginal","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom",256)
	F.Data.DataTable.SaveToDB("dtBomEngOriginal","con","Bom_Eng","Part*!*Location",256)
	F.Data.DataTable.Close("dtBomMstrOriginal")
	F.Data.DataTable.Close("dtBomEngOriginal")

	'Call Core Screen to display Quote or Sales Order
	F.Intrinsic.String.ConcatCallWrapperArgs(V.Screen.frmQte!txtQuote.Text,"O","*!*ZDR*!*",V.Local.sParams)
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		Gui.frmQte.lblStatus.Caption("Launching Quote....")
		F.Global.General.CallWrapperSync(251000,V.Local.sParams)
	F.Intrinsic.Control.Else
		Gui.frmQte.lblStatus.Caption("Launching Sales Order....")
		F.Global.General.CallWrapperSync(200000,v.Local.sParams)
	F.Intrinsic.Control.EndIf

	Gui.frmQte.txtQuote.Text("")
	Gui.frmQte.cboCust.Text("")
	Gui.frmQte.cboCustName.Text("")
	Gui.frmQte.txtCustPO.Text("")
	Gui.frmQte.optTopLevel.Value(True)
	Gui.frmQte.txtLine.Text("001")
	Gui.frmQte.txtLineSuf.Text("0")
	Gui.frmQte.txtQty.Text("0.00")
	Gui.frmQte.txtQtyOnHand.Text("0.00")
	Gui.frmQte.txtQtyReq.Text("0.00")
	Gui.frmQte.chkAutoWO.Value(0)
	F.Data.DataTable.DeleteRow("dtLines")
	Gui.frmComments.txtGroup.Text("")
	Gui.frmComments.txtComments.Text("")
	F.Intrinsic.Control.If(V.DataTable.dtComments.Exists)
		F.Data.DataTable.DeleteRow("dtComments")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(GenerateKey)
	F.Intrinsic.Control.CallSub(Clear)
	Gui.frmQte.lblStatus.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ProcessExisting.End

Program.Sub.ProcessNewOne.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Create Web Importer File and call ORDUPL to upload the Quote/Sales Order

	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.sRet3.Declare
	V.Local.sTemp.Declare
	V.Local.sFileContents.Declare
	V.Local.sFile.Declare
	V.Local.sMoveFile.Declare
	V.Local.sNumber.Declare
	V.Local.sParams.Declare
	V.Local.sSql.Declare
	V.Local.bExists.Declare
	V.Local.iRet.Declare
	V.Local.iLine.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare

	'Exit Sub if DataTable is Empty
	F.Intrinsic.Control.If(V.DataTable.dtLines.Exists,=,False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtLines.RowCount,=,0)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	Gui.frmQte.lblStatus.Caption("Uploading Data....")
	Gui.frmQte.lblStatus.Visible(True)
	
	F.Intrinsic.Control.If(V.DataTable.dtSubs.Exists)
		F.Data.DataTable.Close("dtSubs")
	F.Intrinsic.Control.EndIf
	
	'Save BOM subs and Grouping
	F.Data.DataView.Create("dtLines","dvLines")
	F.Data.DataView.ToDataTable("dtLines","dvLines","dtSubs",True)
	F.Data.DataView.Close("dtLines","dvLines")
	F.Data.DataTable.AddColumn("dtSubs","CSID",Long,0)
	F.Data.DataTable.CopyColumn("dtSubs","Group","GRPID",True)
	F.Data.DataTable.CopyColumn("dtSubs","ParentLine","PARENT_LINE",True)
	F.Data.DataTable.CopyColumn("dtSubs","ParentFlag","PARENT",True)
	F.Data.DataTable.CopyColumn("dtSubs","PartOrig","PART_ORIG",True)
	F.Data.DataTable.CopyColumn("dtSubs","Part","PART_SUB",True)
	F.Data.DataTable.CopyColumn("dtSubs","BomSeq","BOM_SEQ",True)
	F.Data.DataTable.RemoveColumn("dtSubs","Qty")
	F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY",True)
	F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY_6",True)
	F.Data.DataTable.AddColumn("dtSubs","QUOTE_NO",String)
	F.Data.DataTable.AddColumn("dtSubs","ORDER_NO",String)
	F.Data.DataTable.AddColumn("dtSubs","ORDLN",Long,0)
	F.Data.DataTable.SetSeries("dtSubs","ORDLN",1,1)
	F.Data.DataTable.RemoveColumn("dtSubs","Line")
	F.Data.DataTable.RemoveColumn("dtSubs","LineSuf")
	F.Data.DataTable.RemoveColumn("dtSubs","Group")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentLine")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentLine2")
	F.Data.DataTable.RemoveColumn("dtSubs","Customer")
	F.Data.DataTable.RemoveColumn("dtSubs","CustomerName")
	F.Data.DataTable.RemoveColumn("dtSubs","CustPO")
	F.Data.DataTable.RemoveColumn("dtSubs","ParentFlag")
	F.Data.DataTable.RemoveColumn("dtSubs","BomSeq")
	F.Data.DataTable.RemoveColumn("dtSubs","Router")
	F.Data.DataTable.RemoveColumn("dtSubs","PartOrig")
	F.Data.DataTable.RemoveColumn("dtSubs","Part")
	F.Data.DataTable.RemoveColumn("dtSubs","Location")
	F.Data.DataTable.RemoveColumn("dtSubs","PartBrw")
	F.Data.DataTable.RemoveColumn("dtSubs","Description")
	F.Data.DataTable.RemoveColumn("dtSubs","ProdLine")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyOrig")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyOnHand")
	F.Data.DataTable.RemoveColumn("dtSubs","QtyReq")
	F.Data.DataTable.RemoveColumn("dtSubs","DueDate")
	F.Data.DataTable.RemoveColumn("dtSubs","Pricing")
	F.Data.DataTable.SaveToDB("dtSubs","con","GAB_4812_BOM_CFGSUBS","CSID")
	F.Data.DataTable.Close("dtSubs")
	
	'Open Blank Bom DataTables
	F.Data.DataTable.CreateFromSQL("dtBomMstrOriginal","con","Select * From Bom_Mstr Where Parent = '-1';",True)
	F.Data.DataTable.CreateFromSQL("dtBomEngOriginal","con","Select * From Bom_Eng Where Part = '-1';",True)

	'Loop through dtLines and format before calling upload
	'One each element , clear sRet first, this is incase that element is not used.
	'When formatting each element of the datatable, return the final formatted element to 'v.local.sRet', it is already programmed to use that as the variable when building the file

	'REQUIRED FILEDS ARE NOTED WITH ***REQUIRED***
	'***FIELD,Length,StartPosition-Description if Available
	
	F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(0).ParentFlag!FieldValTrim)
		F.Intrinsic.Control.CaseAny("N","Y")
			F.Intrinsic.Control.If(V.DataTable.dtLines(0).ParentFlag!FieldValTrim,=,Y)
				F.Intrinsic.String.Build("ParentLine = {0}",V.DataTable.dtLines(0).Line!FieldVal,V.Local.sExp)
				F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
				F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
					F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
					F.Intrinsic.Control.For(V.Local.iCnt2,0,V.Local.sSelect.UBound,1)
						F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,=,"0000")
							'Bom_Mstr
							F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
							F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
							F.Data.DataTable.Merge("dtBomMstr","dtBomMstrOriginal",True,3)
							F.Data.DataTable.Close("dtBomMstr")
							F.Intrinsic.String.Build("Delete From Bom_Mstr Where Parent = '{0}' And Sequence_Bom <> '0000';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
							F.ODBC.Connection!con.Execute(V.Local.sSql)
							'Inventory_Mstr
							F.Intrinsic.String.Build("Select * From Inventory_Mstr Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
							F.Data.DataTable.CreateFromSQL("dtInvBom","con",V.Local.sSql,True)
							F.Data.DataTable.SetValue("dtInvBom",-1,"Code_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Pricing!FieldVal)
							F.Data.DataTable.SaveToDB("dtInvBom","con","Inventory_Mstr","Part*!*Location")
							F.Data.DataTable.Close("dtInvBom")
						F.Intrinsic.Control.Else
							'Update BOM_MSTR
							F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}' And Sequence_Bom = '{1}' And Part = '{2}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
							F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
							F.Intrinsic.Control.If(V.DataTable.dtBomMstr.RowCount,<>,0)
								F.Data.DataTable.SetValue("dtBomMstr",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal)
							F.Intrinsic.Control.Else
								F.Intrinsic.String.Build("Select Cost From Inventory_Cost Where Part = '{0}' And Locn = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
								F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
								F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
									V.Local.sRet.Set(0)
								F.Intrinsic.Control.EndIf
								F.Intrinsic.String.Build("Select UM_Inventory From Inventory_Mstr Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
								F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
								F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
									V.Local.sRet2.Set(0)
								F.Intrinsic.Control.EndIf
								F.Intrinsic.String.Build("Select Code_Source From Inventory_Mst2 Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
								F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet3)
								F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
									V.Local.sRet3.Set(0)
								F.Intrinsic.Control.EndIf
								F.Data.DataTable.AddRow("dtBomMstr","Parent",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldValTrim,"Sequence_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,"Insert_Bom","00","Date_Maintenance",V.Ambient.Date.FormatMMDDYY,"Cost",V.Local.sRet.Trim,"Quantity",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Date_Start","000000","Date_Stop","000000","UM_Inventory",V.Local.sRet2.Trim,"Ordr_Usr_Flag","N","Quantity_6",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Source",V.Local.sRet3.Trim,"Frequency","0","Date_Last_Chg",V.Ambient.Date.FormatYYYYMMDD,"Time_Last_Chg","00000000","Last_Chg_By",V.Caller.User,"Last_Chg_Prog","ARC4812","Req_Trace","N","Cost_Date","00000000","Bom_Complete","Y","Inactive",False,"Chg_Rev","0","Setup_Qty","0.0000")
							F.Intrinsic.Control.EndIf
							F.Data.DataTable.SaveToDB("dtBomMstr","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom")
							F.Data.DataTable.Close("dtBomMstr")
							'Update BOM_ENG
							F.Intrinsic.String.Build("Select * From Bom_Eng Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
							F.Data.DataTable.CreateFromSQL("dtBomEng","con",V.Local.sSql,True)
							F.Data.DataTable.Merge("dtBomEng","dtBomEngOriginal",True,3)
							F.Data.DataTable.SetValue("dtBomEng",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Description",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Description!FieldVal)
							F.Data.DataTable.SaveToDB("dtBomEng","con","Bom_Eng","Part*!*Location")
							F.Data.DataTable.Close("dtBomEng")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iCnt2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
			'Transaction, 1,1 Transaction Code:  ""O"" for sales order or ""Q"" for Quote    ***REQUIRED***
				F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
					V.Local.sTemp.Set("Q")
				F.Intrinsic.Control.Else
					V.Local.sTemp.Set("O")
				F.Intrinsic.Control.EndIf
	
			'Customer, 7,2 Customer Number: ***REQUIRED*** unless using ordupmnu to choose customer id.
				F.Intrinsic.String.RPad(V.DataTable.dtLines(0).Customer!FieldValTrim," ",7,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
	
			'OrderNo, 7,9 If AutoNumbering Turned on can be left blank, otherwise a required field with leading zeros
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",15,V.Local.sTemp)
	
			'Freight,10,16 Freight amount  8.2  Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50     0000000250
				V.Local.sRet.Set("")
'				F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.i)!Freight,"0.00",v.uGlobal.uOrders(v.Local.i)!Freight)
'				F.Intrinsic.String.Replace(v.uGlobal.uOrders(v.Local.i)!Freight,".","",v.uGlobal.uOrders(v.Local.i)!Freight)
'				F.Intrinsic.String.LPad(v.uGlobal.uOrders(v.Local.i)!Freight,"0",10,v.Local.sRet)
				F.Intrinsic.String.LPad("","0",10,v.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",25,V.Local.sTemp)
	
			'Tax Freight Flag,1,26 Flag Y N or blank
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",26,V.Local.sTemp)
	
			'Freight Per Piece,1,27 Flag Y N or blank
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",27,V.Local.sTemp)
	
			'Order Date Due,8,28 CCYYMMDD   Example entry of Aug 5 2006     20060806
				V.Local.sRet.Set("")
				F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",35,V.Local.sTemp)
	
			'Order Date,8,36 CCYYMMDD   Example entry of Aug 5 2006     20060806
				V.Local.sRet.Set("")
				F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",43,V.Local.sTemp)
	
			'User 1 Header,30,44 User Field for Header up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",73,V.Local.sTemp)
	
			'User Field 2 Header,30,74 User Field for Header up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",103,V.Local.sTemp)
	
			'User Field 3 Header,30,104 User Field for Header up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",133,V.Local.sTemp)
	
			'User Field 4 Header,30,134 User Field for Header up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",163,V.Local.sTemp)
	
			'User Field 5 Header,30,164 User Field for Header up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",193,V.Local.sTemp)
	
			'UserId,8,194 User Field for Header up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",201,V.Local.sTemp)
	
			'CustomerPO,15,202 User Field for Header up to 30 characters
				V.Local.sRet.Set(V.DataTable.dtLines(0).CustPO!FieldValTrim)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",231,V.Local.sTemp)
	
			'Filler_1,15,217,Not Used- Leave Blank
	
			'Freight_CurrFlag,1,232,Y N or blank
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",232,V.Local.sTemp)
	
			'Data Type,1,233,"""S"" for shipping data"
				V.Local.sRet.Set("S")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",233,V.Local.sTemp)
	
			'Ship Via,20,234
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",253,V.Local.sTemp)
	
			'Carrier,6,254
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",259,V.Local.sTemp)
	
			'Ship To Name,30,260
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",289,V.Local.sTemp)
	
			'Ship To Address 1,30,290
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",319,V.Local.sTemp)
	
			'Ship To Address 2,30,320
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",349,V.Local.sTemp)
	
			'Ship To Address 3,30,350
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",379,V.Local.sTemp)
	
			'Ship To City,25,380
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",404,V.Local.sTemp)
	
			'Ship To State,2,405
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",406,V.Local.sTemp)
	
			'Ship To Zip,13,407
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",419,V.Local.sTemp)
	
			'Ship To Country,3,420
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",422,V.Local.sTemp)
	
			'ShipToAttention,30,423
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",463,V.Local.sTemp)
	
			'filler in reusable area,11,453,Not in Use
	
			'Order type,1,464,"Regular = blank or spaces, Invoice = ""X"
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",464,V.Local.sTemp)
	
			'Order Discount Percentage,5,465,1.4 with an implied decimal (example:  45% would show as 04500 in the file
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",469,V.Local.sTemp)
	
			'Salesman,3,470,Salesman code within GSS
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",472,V.Local.sTemp)
	
			'PAY-METHOD , 2,473
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",474,V.Local.sTemp)
	
			'PAY-OWNER-NAME,30,475
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",504,V.Local.sTemp)
	
			'PAY-CC-TYPE ,2,505
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",506,V.Local.sTemp)
	
			'PAY-CC-NO , 25,507
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",531,V.Local.sTemp)
	
			'PAY-CC-LENGTH , 2,532
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",533,V.Local.sTemp)
	
			'PAY-CC-EXP-DT , 6,534
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",539,V.Local.sTemp)
	
			'PAY-CC-CVV , 7, 540
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",546,V.Local.sTemp)
	
			'PAY-CVV-LENGTH 1, 547 Numeric(1 or 0)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",547,V.Local.sTemp)
	
			'Override auto numbering,1,548,"Populate with ""1"" will override the auto ordering number with the number provided in the order number above
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",548,V.Local.sTemp)
	
			'Ship To Id,6,549,"Optional, must be valid for customer
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",554,V.Local.sTemp)
	
			'Mark Shipment,30,555
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",584,V.Local.sTemp)
	
			'Contact Name,30,585
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",614,V.Local.sTemp)
	
			'From Location, 2,615
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",701,V.Local.sTemp)
	
			'Filler_3,85,617,Not in Use
	
'************************************************************************************Line Data************************************************************************************
			'Line Number,3,702,Not ***REQUIRED*** Valid input is 1 through 999
				V.Local.sRet.Set(V.DataTable.dtLines(0).Line!FieldValTrim)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet.Format#,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",705,V.Local.sTemp)
	
			'Filler_Line,1,705,Not Used- Leave Blank
	
			'Qty Ordered,13,706,9.4; REQUIRED  Must enter numeric values with a filler or zeroes- do not enter spaces.  Example entry of 10  0000000100000
				V.Local.sRet.Set("")
				F.Intrinsic.String.Format(V.DataTable.dtLines(0).Qty!FieldVal,"0.0000",V.Local.sRet)
				F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet,"0",13,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",718,V.Local.sTemp)
	
			'Weight,10,719,7.3 Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50 would be 0000002500
				V.Local.sRet.Set("")
				'F.Intrinsic.String.Format(V.DataTable.dtLines(0).TotWeight!FieldVal,"0.000",V.Local.sRet)
				F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet,"0",10,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",728,V.Local.sTemp)
	
			'Unit Of Measure,2,729,Unit of Measure
				V.Local.sRet.Set(V.DataTable.dtLines(0).UM!FieldValTrim)
				F.Intrinsic.String.RPad(V.Local.sRet," ",2,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",730,V.Local.sTemp)
	
			'*** 20 Char Part# - PART, 20,731***REQUIRED***
			'Part Number,17,731,17 character part number
			'Part Rev,3,748,***REQUIRED*** if using part rev and a revision exists OR if NOT using part revision and part is longer than 17 characters long.
				V.Local.sRet.Set(V.DataTable.dtLines(0).Part!FieldValTrim)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",768,V.Local.sTemp)
	
			'Filler,18,751,Not in Use - Leave Blank
	
			'Part Location,2,769,Location code
				V.Local.sRet.Set(V.DataTable.dtLines(0).Location!FieldValTrim)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",770,V.Local.sTemp)
	
			'Quoted Price,16,771,10.6; REQUIRED in company currency.
			'Make sure to fill in discount price even if no discounts apply.
			'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
				V.Local.sRet.Set("")
				F.Intrinsic.String.Replace(v.Local.sRet,".","",v.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",786,V.Local.sTemp)
	
			'OverRidePrice,16,787,10.6; any price over-rides in company currency.
			'Make sure to fill in discount price even if no discounts apply.
			'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",802,V.Local.sTemp)
	
			'Cost,16,803,10.6; Cost of the Part in company currency.
			'Enter leading zeros - do not enter spaces.   Example of 12.50  00000012500000
				V.Local.sRet.Set("")
'				F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.i)!Cost,"0.000000",v.uGlobal.uOrders(v.Local.i)!Cost)
'				F.Intrinsic.String.Replace(v.uGlobal.uOrders(v.Local.i)!Cost,".","",v.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",818,V.Local.sTemp)
	
			'DescriptionPart,30,819,Description of the Part Number Length of 30
				V.Local.sRet.Set(V.DataTable.dtLines(0).Description!FieldValTrim)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",848,V.Local.sTemp)
	
			'Product Line,3,849,Product Line of part number
'					V.Local.sRet.Set(v.uGlobal.uOrders(v.Local.i)!PL)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",851,V.Local.sTemp)
	
			'Line Order Date,8,852,CCYYMMDD  Example entry of Aug 5 2006     20060806
				V.Local.sRet.Set("")
				F.Intrinsic.String.Format(v.Ambient.Date,"YYYYMMDD",v.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",859,V.Local.sTemp)
	
			'Line Promise Date,8,860,CCYYMMDD  Example entry of Aug 5 2006     20060806
				V.Local.sRet.Set("")
'				F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.iOrder)!DateDue_Order,"YYYYMMDD",v.Local.sRet)
				F.Intrinsic.String.Format(V.Ambient.Date,"YYYYMMDD",v.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",867,V.Local.sTemp)
	
			'User Field 1,30,868,User Field forLine up to 30 characters
				V.Local.sRet.Set(V.DataTable.dtLines(0).Group!FieldValTrim)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",897,V.Local.sTemp)
	
			'User Field 2,30,898,User Field forLine up to 30 characters
				V.Local.sRet.Set(V.DataTable.dtLines(0).ParentLine!FieldValTrim)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",927,V.Local.sTemp)
	
			'User Field 3,30,928,User Field forLine up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",957,V.Local.sTemp)
	
			'User Field 4,30,958,User Field forLine up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",987,V.Local.sTemp)
	
			'User Field 5,30,988,User Field forLine up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1017,V.Local.sTemp)
	
			'Extention,16,1018,"10.6 in company currency.
			'Leading zeros - no spaces or commas.  Example of 1,250.21  0000001250210000
				V.Local.sRet.Set("")
'				F.Intrinsic.String.Format(v.uGlobal.uOrders(v.Local.i)!Extention,"0.000000",v.uGlobal.uOrders(v.Local.i)!Extention)
'				F.Intrinsic.String.Replace(v.uGlobal.uOrders(v.Local.i)!Extention,".","",v.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1033,V.Local.sTemp)
	
			'No Delivery Before Date,8,1034,CCYYMMDD  Example entry of Aug 5 2006     20060806
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1041,V.Local.sTemp)
	
			'Must Deliver By Date,8,1042,CCYYMMDD  Example entry of Aug 5 2006     20060806
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1049,V.Local.sTemp)
	
			'vvv EXTRA TEXT vvv
	
			'DataType,1,1050,"""T"" for sales order text
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,"",V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1050,V.Local.sTemp)
	
			'Text Line 1,30,1051,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE1.Trim)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1080,V.Local.sTemp)
	
			'Text Line 2,30,1081,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE2.Trim)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1110,V.Local.sTemp)
	
			'Text Line 3,30,1111,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE3.Trim)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1140,V.Local.sTemp)
	
			'Text Line 4,30,1141,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE4.Trim)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1170,V.Local.sTemp)
	
			'Text Line 5,30,1171,Additional Text for Line up to 30 characters
'					V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!TEXT_LINE5.Trim)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1200,V.Local.sTemp)
	
			'Text Line 6,30,1201,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1230,V.Local.sTemp)
	
			'Text Line 7,30,1231,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1260,V.Local.sTemp)
	
			'Text Line 8,30,1261,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1290,V.Local.sTemp)
	
			'Text Line 9,30,1291,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1320,V.Local.sTemp)
	
			'Text Line 10,30,1321,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1350,V.Local.sTemp)
	
			'Tax Status Flag,1,1351,"""E"" for exempt, ""T"" for taxable
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1351,V.Local.sTemp)
	
			'Line Type,1,1352,"""B"" for buyout, ""D"" for dropship, ""S"" for standard, ""C"" for consignment
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1352,V.Local.sTemp)
	
			'Negative Flag,1,1353,"""1"" = The order qty is negative for this line."
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1353,V.Local.sTemp)
	
			'Price Flag,1,1354,"""1"" = Accept zero price for this line.
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1354,V.Local.sTemp)
	
			'Sufficient Inventory Check,1,1355,"""1"" = Check to make sure inventory level is sufficient for this line.
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1355,V.Local.sTemp)
	
			'Survey No ,8,1356
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1363,V.Local.sTemp)
	
			'Router Val Flag 1,1364
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1364,V.Local.sTemp)
	
			'Router , 20,1365
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1384,V.Local.sTemp)
	
			'Router Seq ,6,1385
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1390,V.Local.sTemp)
	
			'STOCK-XREF, 1,1391
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1391,V.Local.sTemp)
	
			'Origin Order ,7,1392
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1398,V.Local.sTemp)
	
			'Origin Line,3,1399
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1401,V.Local.sTemp)
	
			'Length ,12,1402 Numeric(8,4)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1413,V.Local.sTemp)
	
			'WIDTH ,12,1414 Numeric(8,4)
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1425,V.Local.sTemp)
	
			'CURR-FLAG ,1,1426
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1426,V.Local.sTemp)
	
			'Order Discount Percentage,5,1427,Order Line Discount format.
			'The field contains 1 leading digit and four decimals.  So 00500 would be entered for a 5% discount.
				V.Local.sRet.Set("")
'				F.Intrinsic.Control.If(V.uGlobal.uOrders(v.Local.i)!Order_Disc_Pct.Trim,<>,"")
'				F.Intrinsic.String.Split(V.uGlobal.uOrders(v.Local.i)!Order_Disc_Pct,".",V.Local.sRet)
'				F.Intrinsic.String.RPad(V.Local.sRet(1),"0",4,V.Local.sRet)
'				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.LPad(V.Local.sRet,"0",5,V.Local.sRet)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1517,V.Local.sTemp)
	
			'Filler,86,1432,Not in Use - Leave Blank
	
'************************************************************************************Extended Header Data************************************************************************************
			'Ship To International Flag,1,1518,"""Y"" for international address, ""N"" or spaces for domestic address
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1518,V.Local.sTemp)
	
			'Ship To Name,40,1519
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1558,V.Local.sTemp)
	
			'Ship To Address 1,40,1559
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1598,V.Local.sTemp)
	
			'Ship To Address 2,40,1599
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1638,V.Local.sTemp)
	
			'Ship To Address 3,40,1639
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1678,V.Local.sTemp)
	
			'Ship To Address 4,40,1679
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1718,V.Local.sTemp)
	
			'Ship To Address 5,40,1719
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1758,V.Local.sTemp)
	
			'Ship To City,25,1759
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1783,V.Local.sTemp)
	
			'Ship To State,2,1784
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1785,V.Local.sTemp)
	
			'Ship To Zip,13,1786
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1798,V.Local.sTemp)
	
			'Ship To Country,25,1799
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1823,V.Local.sTemp)
	
			'Ship To Attention,40,1824
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",1863,V.Local.sTemp)
	
'************************************************************************************Bill To Data************************************************************************************
			'Bill To International Flag,1,1864,"""Y"" for international address, ""N"" or spaces for domestic address
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1864,V.Local.sTemp)
	
			'Bill To Name,40,1865
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1904,V.Local.sTemp)
	
			'Bill To Address 1,40,1905
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1943,V.Local.sTemp)
	
			'Bill To Address 2,40,1945
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",1984,V.Local.sTemp)
	
			'Bill To Address 3,40,1985
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2024,V.Local.sTemp)
	
			'Bill To Address 4,40,2025
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2064,V.Local.sTemp)
	
			'Bill To Address 5,40,2065
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2104,V.Local.sTemp)
	
			'Bill To City,25,2105
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2129,V.Local.sTemp)
	
			'Bill To State,2,2130
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2131,V.Local.sTemp)
	
			'Bill To Zip,13,2132
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2144,V.Local.sTemp)
	
			'Bill To Country,25,2145
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2169,V.Local.sTemp)
	
			'Bill To Attention,40,2170
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2209,V.Local.sTemp)
	
			'Contact's Email Address,100,2210
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2309,V.Local.sTemp)
	
			'Contact's Phone,20,2310
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2329,V.Local.sTemp)
	
'************************************************************************************Sales Order Header Text Data************************************************************************************
			'Text Line 1,30,2330,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2359,V.Local.sTemp)
	
			'Text Line 2,30,2360,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2389,V.Local.sTemp)
	
			'Text Line 3,30,2390,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2419,V.Local.sTemp)
	
			'Text Line 4,30,2420,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2449,V.Local.sTemp)
	
			'Text Line 5,30,2450,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2479,V.Local.sTemp)
	
			'Text Line 6,30,2480,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2509,V.Local.sTemp)
	
			'Text Line 7,30,2510,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2539,V.Local.sTemp)
	
			'Text Line 8,30,2540,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2569,V.Local.sTemp)
	
			'Text Line 9,30,2570,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2599,V.Local.sTemp)
	
			'Text Line 10,30,2600,Additional Text for Line up to 30 characters
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2629,V.Local.sTemp)
	
			'Text Position,1,2630,"""H"" for header, ""F"" for footer
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2630,V.Local.sTemp)
	
			'Apply Text to Sales Order,1,2631,"""Y"" to apply, ""N"" for do not apply
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2631,V.Local.sTemp)
	
			'Apply Text to Packing List,1,2632,"""Y"" to apply, ""N"" for do not apply
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2632,V.Local.sTemp)
	
			'Apply Text to Invoice,1,2633,"""Y"" to apply, ""N"" for do not apply
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2633,V.Local.sTemp)
	
			'Apply Text to Quote,1,2634,"""Y"" to apply, ""N"" for do not apply
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2634,V.Local.sTemp)
	
			'Apply Text to Router,1,2635,"""Y"" to apply, ""N"" for do not apply
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2636,V.Local.sTemp)
	
			'Apply Text to Work Order,1,2636,"""Y"" to apply, ""N"" for do not apply
				V.Local.sRet.Set("")
				F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
				F.Intrinsic.String.RPad(V.Local.sTemp," ",2637,V.Local.sTemp)
	
			'Filler,1000,2637,Not in Use - Leave Blank
	
			'Filler,1000,3637,Not in Use - Leave Blank
	
			'***Total Record length of,4565 if all used
	
			'Build File Contents in Separate Temp Var
			F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sFileContents,V.Local.sTemp,V.Ambient.NewLine,V.Local.sFileContents)
	F.Intrinsic.Control.EndSelect

	'Create Web_Order Directories
	F.Intrinsic.String.Build("{0}\WEB_ORDERS",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\CONVERTED",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\WEB_ERRORS",V.Caller.FilesDir,v.Local.sFile)
	F.Intrinsic.File.CreateDir(v.Local.sFile)

	'String to File containing sFileContents to V.Local.sFile
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sFile)
	F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED\{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sMoveFile)
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sFileContents)
	V.Local.sFileContents.Set("")

	'Call Upload Web Importer ORDUPL (File: GSSPARAM.txt)
	F.Global.General.CallWrapperSync(50,"ORDUPL")
	Gui.frmQte.lblStatus.Caption("Upload Complete")
	
	'Move file if not moved already
	F.Intrinsic.Control.If(V.Local.sNumber,<>,"")
		F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bExists)
		F.Intrinsic.Control.If(V.Local.bExists)
			F.Intrinsic.File.MoveFile(V.Local.sFile,V.Local.sMoveFile,V.Local.iRet)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	'Get last Quote/Sales Order number uploaded
	F.Intrinsic.String.Build("Select * From GAB_4812_BOM_CFGSUBS Where RanKey = {0};",V.Global.iRanKey,V.Local.sSql)
	F.Data.DataTable.CreateFromSQL("dtSubs","con",V.Local.sSql,True)
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		F.Intrinsic.String.Build("Select Top 1 Quote_No From V_Quote_Header Where Date_Quote = '{0}' And Last_Chg_By = '{1}' And Last_Chg_Pgm = 'ORDUP3' Order By Quote_No Desc;",V.Ambient.Date.PervasiveDate,V.Caller.User,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sNumber)
		'Update Quote in Sub Table
		F.Data.DataTable.SetValue("dtSubs",-1,"QUOTE_NO",V.Local.sNumber)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("Select Top 1 Order_No From V_Order_Header Where Date_Order = '{0}' And Last_Chg_By = '{1}' And Last_Chg_Pgm = 'ORDUP3' Order By Order_No Desc;",V.Ambient.Date.PervasiveDate,V.Caller.User,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sNumber)
		'Update Order in Sub Table
		F.Data.DataTable.SetValue("dtSubs",-1,"ORDER_NO",V.Local.sNumber)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.SaveToDB("dtSubs","con","GAB_4812_BOM_CFGSUBS","CSID")
	F.Data.DataTable.Close("dtSubs")
	V.Global.sQuoteNo.Set(V.Local.sNumber)
	
	'Put Original BOM back
	Gui.frmQte.lblStatus.Caption("Saving Original BOMs....")
	F.Data.DataTable.Select("dtBomMstrOriginal","Sequence_Bom = '0000'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			F.Intrinsic.String.Build("Delete From Bom_Mstr Where Parent = '{0}';",V.DataTable.dtBomMstrOriginal(V.Local.sSelect(V.Local.iCnt).Long).Parent!FieldVal,V.Local.sSql)
			F.ODBC.Connection!con.Execute(V.Local.sSql)
		F.Intrinsic.Control.Next(V.Local.iCnt)
		F.Data.DataTable.SaveToDB("dtBomMstrOriginal","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom",256)
		F.Data.DataTable.SaveToDB("dtBomEngOriginal","con","Bom_Eng","Part*!*Location",256)
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.Close("dtBomMstrOriginal")
	F.Data.DataTable.Close("dtBomEngOriginal")
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ProcessNewOne.End

Program.Sub.ProcessExistingOne.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Create Web Importer File and call ORDUPL to upload the Quote/Sales Order

	V.Local.iCnt.Declare
	V.Local.iCnt2.Declare
	V.Local.sRet.Declare
	V.Local.sRet2.Declare
	V.Local.sRet3.Declare
	V.Local.sTemp.Declare
	V.Local.sFileContents.Declare
	V.Local.sFile.Declare
	V.Local.sMoveFile.Declare
	V.Local.sNumber.Declare
	V.Local.sParams.Declare
	V.Local.sSql.Declare
	V.Local.bExists.Declare
	V.Local.iRet.Declare
	V.Local.iLine.Declare
	V.Local.sExp.Declare
	V.Local.sSelect.Declare
	V.Local.iStart.Declare

	'Exit Sub if DataTable is Empty
	F.Intrinsic.Control.If(V.DataTable.dtLines.Exists,=,False)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtLines.RowCount,=,0)
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	Gui.frmQte.lblStatus.Caption("Uploading Data....")
	Gui.frmQte.lblStatus.Visible(True)
	
	F.Intrinsic.Control.If(V.DataTable.dtSubs.Exists)
		F.Data.DataTable.Close("dtSubs")
	F.Intrinsic.Control.EndIf
	
	'Save BOM subs and Grouping
	F.Intrinsic.Control.If(V.Args.Call,=,"First")
		F.Data.DataView.Create("dtLines","dvLines")
		F.Data.DataView.ToDataTable("dtLines","dvLines","dtSubs",True)
		F.Data.DataView.Close("dtLines","dvLines")
		F.Data.DataTable.AddColumn("dtSubs","CSID",Long,0)
		F.Data.DataTable.CopyColumn("dtSubs","Group","GRPID",True)
		F.Data.DataTable.CopyColumn("dtSubs","ParentLine","PARENT_LINE",True)
		F.Data.DataTable.CopyColumn("dtSubs","ParentFlag","PARENT",True)
		F.Data.DataTable.CopyColumn("dtSubs","PartOrig","PART_ORIG",True)
		F.Data.DataTable.CopyColumn("dtSubs","Part","PART_SUB",True)
		F.Data.DataTable.RemoveColumn("dtSubs","Qty")
		F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY",True)
		F.Data.DataTable.CopyColumn("dtSubs","QtyOrig","QTY_6",True)
		F.Data.DataTable.AddColumn("dtSubs","QUOTE_NO",String)
		F.Data.DataTable.AddColumn("dtSubs","ORDER_NO",String)
		F.Data.DataTable.AddColumn("dtSubs","ORDLN",Long,0)
		F.Data.DataTable.SetSeries("dtSubs","ORDLN",1,1)
		F.Data.DataTable.RemoveColumn("dtSubs","Line")
		F.Data.DataTable.RemoveColumn("dtSubs","LineSuf")
		F.Data.DataTable.RemoveColumn("dtSubs","Group")
		F.Data.DataTable.RemoveColumn("dtSubs","ParentLine")
		F.Data.DataTable.RemoveColumn("dtSubs","ParentLine2")
		F.Data.DataTable.RemoveColumn("dtSubs","Customer")
		F.Data.DataTable.RemoveColumn("dtSubs","CustomerName")
		F.Data.DataTable.RemoveColumn("dtSubs","CustPO")
		F.Data.DataTable.RemoveColumn("dtSubs","ParentFlag")
		F.Data.DataTable.RemoveColumn("dtSubs","BomSeq")
		F.Data.DataTable.RemoveColumn("dtSubs","Router")
		F.Data.DataTable.RemoveColumn("dtSubs","PartOrig")
		F.Data.DataTable.RemoveColumn("dtSubs","Part")
		F.Data.DataTable.RemoveColumn("dtSubs","Location")
		F.Data.DataTable.RemoveColumn("dtSubs","PartBrw")
		F.Data.DataTable.RemoveColumn("dtSubs","Description")
		F.Data.DataTable.RemoveColumn("dtSubs","ProdLine")
		F.Data.DataTable.RemoveColumn("dtSubs","QtyOrig")
		F.Data.DataTable.RemoveColumn("dtSubs","QtyOnHand")
		F.Data.DataTable.RemoveColumn("dtSubs","QtyReq")
		F.Data.DataTable.RemoveColumn("dtSubs","DueDate")
		F.Data.DataTable.RemoveColumn("dtSubs","Pricing")
		F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
			'Update Quote in Sub Table
			F.Data.DataTable.SetValue("dtSubs",-1,"QUOTE_NO",V.Global.sQuoteNo)
		F.Intrinsic.Control.Else
			'Update Order in Sub Table
			F.Data.DataTable.SetValue("dtSubs",-1,"ORDER_NO",V.Global.sQuoteNo)
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SaveToDB("dtSubs","con","GAB_4812_BOM_CFGSUBS","CSID")
		F.Data.DataTable.Close("dtSubs")
	F.Intrinsic.Control.EndIf
	
	'Loop through dtLines and format before calling upload
	'One each element , clear sRet first, this is incase that element is not used.
	'When formatting each element of the datatable, return the final formatted element to 'v.local.sRet', it is already programmed to use that as the variable when building the file

	'REQUIRED FILEDS ARE NOTED WITH ***REQUIRED***
	'***FIELD,Length,StartPosition-Description if Available
	
	F.Intrinsic.Control.If(V.Screen.frmQte!optNew.Value)
		V.Local.iStart.Set(1)
	F.Intrinsic.Control.Else
		V.Local.iStart.Set(0)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.For(V.Local.iCnt,V.Local.iStart,V.DataTable.dtLines.RowCount--,1)
		F.Intrinsic.Control.SelectCase(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim)
			F.Intrinsic.Control.CaseAny("N","Y")
				'Open Blank Bom DataTables
				F.Data.DataTable.CreateFromSQL("dtBomMstrOriginal","con","Select * From Bom_Mstr Where Parent = '-1';",True)
				F.Data.DataTable.CreateFromSQL("dtBomEngOriginal","con","Select * From Bom_Eng Where Part = '-1';",True)
				'------------------------------------------------------------------------------------------------------------
				F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.iCnt).ParentFlag!FieldValTrim,=,Y)
					F.Intrinsic.String.Build("ParentLine = {0}",V.DataTable.dtLines(V.Local.iCnt).Line!FieldVal,V.Local.sExp)
					F.Data.DataTable.Select("dtLines",V.Local.sExp,V.Local.sSelect)
					F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
						F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
						F.Intrinsic.Control.For(V.Local.iCnt2,0,V.Local.sSelect.UBound,1)
							F.Intrinsic.Control.If(V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,=,"0000")
								'Bom_Mstr
								F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
								F.Data.DataTable.Merge("dtBomMstr","dtBomMstrOriginal",True,3)
								F.Data.DataTable.Close("dtBomMstr")
								F.Intrinsic.String.Build("Delete From Bom_Mstr Where Parent = '{0}' And Sequence_Bom <> '0000';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.ODBC.Connection!con.Execute(V.Local.sSql)
								'Inventory_Mstr
								F.Intrinsic.String.Build("Select * From Inventory_Mstr Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtInvBom","con",V.Local.sSql,True)
								F.Data.DataTable.SetValue("dtInvBom",-1,"Code_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Pricing!FieldVal)
								F.Data.DataTable.SaveToDB("dtInvBom","con","Inventory_Mstr","Part*!*Location")
								F.Data.DataTable.Close("dtInvBom")
							F.Intrinsic.Control.Else
								'Update BOM_MSTR
								F.Intrinsic.String.Build("Select * From Bom_Mstr Where Parent = '{0}' And Sequence_Bom = '{1}' And Part = '{2}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomMstr","con",V.Local.sSql,True)
								F.Intrinsic.Control.If(V.DataTable.dtBomMstr.RowCount,<>,0)
									F.Data.DataTable.SetValue("dtBomMstr",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal)
								F.Intrinsic.Control.Else
									F.Intrinsic.String.Build("Select Cost From Inventory_Cost Where Part = '{0}' And Locn = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet.Set(0)
									F.Intrinsic.Control.EndIf
									F.Intrinsic.String.Build("Select UM_Inventory From Inventory_Mstr Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet2.Set(0)
									F.Intrinsic.Control.EndIf
									F.Intrinsic.String.Build("Select Code_Source From Inventory_Mst2 Where Part = '{0}' And Location = '{1}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Location!FieldVal,V.Local.sSql)
									F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet3)
									F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
										V.Local.sRet3.Set(0)
									F.Intrinsic.Control.EndIf
									F.Data.DataTable.AddRow("dtBomMstr","Parent",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).ParentFlag!FieldValTrim,"Sequence_Bom",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).BomSeq!FieldVal,"Insert_Bom","00","Date_Maintenance",V.Ambient.Date.FormatMMDDYY,"Cost",V.Local.sRet.Trim,"Quantity",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Date_Start","000000","Date_Stop","000000","UM_Inventory",V.Local.sRet2.Trim,"Ordr_Usr_Flag","N","Quantity_6",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).QtyOrig!FieldVal,"Source",V.Local.sRet3.Trim,"Frequency","0","Date_Last_Chg",V.Ambient.Date.FormatYYYYMMDD,"Time_Last_Chg","00000000","Last_Chg_By",V.Caller.User,"Last_Chg_Prog","ARC4812","Req_Trace","N","Cost_Date","00000000","Bom_Complete","Y","Inactive",False,"Chg_Rev","0","Setup_Qty","0.0000")
								F.Intrinsic.Control.EndIf
								F.Data.DataTable.SaveToDB("dtBomMstr","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom")
								F.Data.DataTable.Close("dtBomMstr")
								'Update BOM_ENG
								F.Intrinsic.String.Build("Select * From Bom_Eng Where Part = '{0}';",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).PartOrig!FieldVal,V.Local.sSql)
								F.Data.DataTable.CreateFromSQL("dtBomEng","con",V.Local.sSql,True)
								F.Data.DataTable.Merge("dtBomEng","dtBomEngOriginal",True,3)
								F.Data.DataTable.SetValue("dtBomEng",-1,"Part",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Part!FieldVal,"Description",V.DataTable.dtLines(V.Local.sSelect(V.Local.iCnt2).Long).Description!FieldVal)
								F.Data.DataTable.SaveToDB("dtBomEng","con","Bom_Eng","Part*!*Location")
								F.Data.DataTable.Close("dtBomEng")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iCnt2)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
				'Transaction, 1,1 Transaction Code:  ""O"" for sales order or ""Q"" for Quote    ***REQUIRED***
					F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
						V.Local.sTemp.Set("Q")
					F.Intrinsic.Control.Else
						V.Local.sTemp.Set("O")
					F.Intrinsic.Control.EndIf
		
				'Customer, 7,2 Customer Number: ***REQUIRED*** unless using ordupmnu to choose customer id.
					F.Intrinsic.String.RPad(V.DataTable.dtLines(V.Local.iCnt).Customer!FieldValTrim," ",7,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
		
				'OrderNo, 7,9 If AutoNumbering Turned on can be left blank, otherwise a required field with leading zeros
					V.Local.sRet.Set("")
					F.Intrinsic.String.LPad(V.Global.sQuoteNo,"0",7,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",15,V.Local.sTemp)
					
				'*** 20 Char Part# - PART, 20,16***REQUIRED***
				'Part Number,17,16,17 character part number
				'Part Rev,3,33,***REQUIRED*** if using part rev and a revision exists OR if NOT using part revision and part is longer than 17 characters long.
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Part!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,v.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",53,V.Local.sTemp)
		
				'Filler,18,36,Not in Use - Leave Blank
		
				'Part Location,2,54,Location code
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Location!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",55,V.Local.sTemp)
					
				'Product Line,5,56,Product Line of part number
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",61,V.Local.sTemp)
					
				'DescriptionPart,30,61,Description of the Part Number Length of 30
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Description!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",90,V.Local.sTemp)
					
				'Line Number,3,91,Not ***REQUIRED*** Valid input is 1 through 999
'					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Line!FieldValTrim)
					V.Local.sRet.Set("000")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",93,V.Local.sTemp)
					
				'Line Type,1,94,Line Type up to 1 character
					V.Local.sRet.Set("S")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",94,V.Local.sTemp)
					
				'Qty Ordered,13,95,9.4; REQUIRED  Must enter numeric values with a filler or zeroes- do not enter spaces.  Example entry of 10  0000000100000
					V.Local.sRet.Set("")
					F.Intrinsic.String.Format(V.DataTable.dtLines(V.Local.iCnt).Qty!FieldVal,"0.0000",V.Local.sRet)
					F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",13,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",107,V.Local.sTemp)
					
				'Weight,10,108,7.3 Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50 would be 0000002500
					V.Local.sRet.Set("")
					F.Intrinsic.String.Replace(V.Local.sRet,".","",V.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",10,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",117,V.Local.sTemp)
					
				'Quoted Price,16,118,10.6; REQUIRED in company currency.
				'Make sure to fill in discount price even if no discounts apply.
				'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
					V.Local.sRet.Set("")
					F.Intrinsic.String.Replace(v.Local.sRet,".","",v.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",133,V.Local.sTemp)
					
				'User Field 1,30,134,User Field forLine up to 30 characters
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).Group!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",163,V.Local.sTemp)
		
				'User Field 2,30,164,User Field forLine up to 30 characters
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).ParentLine!FieldValTrim)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",193,V.Local.sTemp)
		
				'User Field 3,30,194,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",223,V.Local.sTemp)
		
				'User Field 4,30,224,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",253,V.Local.sTemp)
		
				'User Field 5,30,254,User Field forLine up to 30 characters
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",283,V.Local.sTemp)
					
				'Unit Of Measure,2,284,Unit of Measure
					V.Local.sRet.Set(V.DataTable.dtLines(V.Local.iCnt).UM!FieldValTrim)
					F.Intrinsic.String.RPad(V.Local.sRet," ",2,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",285,V.Local.sTemp)
					
				'Price Flag,1,286,"""1"" = Accept zero price for this line.
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",286,V.Local.sTemp)
		
				'Survey No ,8,287
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",294,V.Local.sTemp)
		
				'Router Val Flag 1,295
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",295,V.Local.sTemp)
		
				'Length ,12,296 Numeric(8,4)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",307,V.Local.sTemp)
		
				'Width ,12,308 Numeric(8,4)
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",319,V.Local.sTemp)
					
				'Cost Flag,1,320,1 = Accept Cost Override
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",320,V.Local.sTemp)
					
				'Cost,16,321,10.6; Cost of the Part in company currency.
				'Enter leading zeros - do not enter spaces.   Example of 12.50  00000012500000
					V.Local.sRet.Set("")
					F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",336,V.Local.sTemp)
					
				'Tax Override Flag,1,337,1 = Accept Tax Override
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",337,V.Local.sTemp)
					
				'Tax Flag,1,338,"""E"" for exempt, ""T"" for taxable
					V.Local.sRet.Set("")
					F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
					F.Intrinsic.String.RPad(V.Local.sTemp," ",339,V.Local.sTemp)
					
				'Filler,45,339,Not Used- Leave Blank
					
				'***Total Record length of 339 if all used
		
				'Build File Contents in Separate Temp Var
				F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sFileContents,V.Local.sTemp,V.Ambient.NewLine,V.Local.sFileContents)
				
				'Create Web_Order Directories
				F.Intrinsic.String.Build("{0}\WEB_ORDERS",V.Caller.FilesDir,v.Local.sFile)
				F.Intrinsic.File.CreateDir(v.Local.sFile)
				F.Intrinsic.String.Build("{0}\WEB_ORDERS\CONVERTED",V.Caller.FilesDir,v.Local.sFile)
				F.Intrinsic.File.CreateDir(v.Local.sFile)
				F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED",V.Caller.FilesDir,v.Local.sFile)
				F.Intrinsic.File.CreateDir(v.Local.sFile)
				F.Intrinsic.String.Build("{0}\WEB_ORDERS\WEB_ERRORS",V.Caller.FilesDir,v.Local.sFile)
				F.Intrinsic.File.CreateDir(v.Local.sFile)
			
				'String to File containing sFileContents to V.Local.sFile
				F.Intrinsic.String.Build("{0}\WEB_ORDERS\LNADD{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sFile)
				F.Intrinsic.String.Build("{0}\WEB_ORDERS\UPLOADED\LNADD{1}{2}.txt",V.Caller.FilesDir,V.Caller.CompanyCode,V.Ambient.Time.FormatHHNNSS,V.Local.sMoveFile)
				F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sFileContents)
				V.Local.sFileContents.Set("")
			
				'CallWrapper 7020 (ORDADLN) (File: GSSPARAM.txt)
				F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Global.sQuoteNo,"Q",V.Local.sFile,V.Local.sParams)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Global.sQuoteNo,"O",V.Local.sFile,V.Local.sParams)
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperSync(7020,V.Local.sParams)
				Gui.frmQte.lblStatus.Caption("Upload Complete")
				
				'Move file if not moved already
				F.Intrinsic.Control.If(V.Global.sQuoteNo,<>,"")
					F.Intrinsic.File.Exists(V.Local.sFile,V.Local.bExists)
					F.Intrinsic.Control.If(V.Local.bExists)
						F.Intrinsic.File.MoveFile(V.Local.sFile,V.Local.sMoveFile,V.Local.iRet)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
				'Put Original BOM back
				Gui.frmQte.lblStatus.Caption("Saving Original BOMs....")
				F.Data.DataTable.SaveToDB("dtBomMstrOriginal","con","Bom_Mstr","Parent*!*Sequence_Bom*!*Insert_Bom",256)
				F.Data.DataTable.SaveToDB("dtBomEngOriginal","con","Bom_Eng","Part*!*Location",256)
				F.Data.DataTable.Close("dtBomMstrOriginal")
				F.Data.DataTable.Close("dtBomEngOriginal")
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Next(V.Local.iCnt)

	'Call Core Screen to display Quote or Sales Order
	F.Intrinsic.String.ConcatCallWrapperArgs(V.Global.sQuoteNo,"O","*!*ZDR*!*",V.Local.sParams)
	F.Intrinsic.Control.If(V.Screen.frmQte!optQte.Value)
		Gui.frmQte.lblStatus.Caption("Launching Quote....")
		F.Global.General.CallWrapperSync(251000,V.Local.sParams)
	F.Intrinsic.Control.Else
		Gui.frmQte.lblStatus.Caption("Launching Sales Order....")
		F.Global.General.CallWrapperSync(200000,v.Local.sParams)
	F.Intrinsic.Control.EndIf

	Gui.frmQte.txtQuote.Text("")
	Gui.frmQte.cboCust.Text("")
	Gui.frmQte.cboCustName.Text("")
	Gui.frmQte.txtCustPO.Text("")
	Gui.frmQte.optTopLevel.Value(True)
	Gui.frmQte.txtLine.Text("001")
	Gui.frmQte.txtLineSuf.Text("0")
	Gui.frmQte.txtQty.Text("0.00")
	Gui.frmQte.txtQtyOnHand.Text("0.00")
	Gui.frmQte.txtQtyReq.Text("0.00")
	Gui.frmQte.chkAutoWO.Value(0)
	F.Data.DataTable.DeleteRow("dtLines")
	Gui.frmComments.txtGroup.Text("")
	Gui.frmComments.txtComments.Text("")
	F.Intrinsic.Control.If(V.DataTable.dtComments.Exists)
		F.Data.DataTable.DeleteRow("dtComments")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.CallSub(GenerateKey)
	F.Intrinsic.Control.CallSub(Clear)
	Gui.frmQte.lblStatus.Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.ProcessExistingOne.End

Program.Sub.cboCust_LostFocus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sFilter.Declare
	V.Local.sSelect.Declare
	V.Local.sCustNo.Declare
	
	F.Intrinsic.Control.If(V.Screen.frmQte!cboCust.Text,<>,"")
		V.Local.sCustNo.Set(V.Screen.frmQte!cboCust.Text)
		F.Intrinsic.String.Build("Customer = '{0}'",V.Local.sCustNo.UCase,V.Local.sFilter)
		F.Data.DataTable.Select("dtCust",V.Local.sFilter,V.Local.sSelect)
		F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
			Gui.frmQte.cboCust.Text(V.Local.sCustNo.UCase)
			Gui.frmQte.cboCustName.Text(V.DataTable.dtCust(V.Local.sSelect.Long).Name_Customer!FieldVal)
			Gui.frmQte.txtCustPO.Text("")
			Gui.frmQte.txtCustPO.Locked(False)
			Gui.frmQte.frameType.Enabled(True)
			Gui.frmQte.frameSel.Enabled(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cboCust_LostFocus.End

Program.Sub.cboCustName_LostFocus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sFilter.Declare
	V.Local.sSelect.Declare
	
	F.Intrinsic.Control.If(V.Screen.frmQte!cboCustName.Text,<>,"")
		F.Intrinsic.String.Build("Name_Customer = '{0}'",V.Screen.frmQte!cboCustName.Text,V.Local.sFilter)
		F.Data.DataTable.Select("dtCust",V.Local.sFilter,V.Local.sSelect)
		F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
			Gui.frmQte.cboCust.Text(V.DataTable.dtCust(V.Local.sSelect.Long).Customer!FieldVal)
			Gui.frmQte.txtCustPO.Text("")
			Gui.frmQte.txtCustPO.Locked(False)
			Gui.frmQte.frameType.Enabled(True)
			Gui.frmQte.frameSel.Enabled(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cboCustName_LostFocus.End

Program.Sub.cboPart_LostFocus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sFilter.Declare
	V.Local.sSelect.Declare
	V.Local.dRet.Declare
	V.Local.sSql.Declare
	V.Local.sRet2.Declare
	
	F.Intrinsic.Control.If(V.Screen.frmQte!cboPart.Text,<>,"")
		F.Intrinsic.String.Build("Part = '{0}'",V.Screen.frmQte!cboPart.Text,V.Local.sFilter)
		F.Data.DataTable.Select("dtPart",V.Local.sFilter,V.Local.sSelect)
		F.Intrinsic.Control.If(V.Local.sSelect,<>,"***NORETURN***")
			Gui.frmQte.cboPart.Text(V.DataTable.dtPart(V.Local.sSelect.Long).Part!FieldValTrim)
			Gui.frmQte.cboLoc.Text(V.DataTable.dtPart(V.Local.sSelect.Long).Location!FieldValTrim)
			Gui.frmQte.txtPartDesc.Caption(V.DataTable.dtPart(V.Local.sSelect.Long).Description!FieldValTrim)
			Gui.frmQte.txtQty.Text("1.00")
			F.Intrinsic.Control.If(V.DataTable.dtPart(V.Local.sSelect.Long).Code_Bom!FieldValTrim,=,"B")
				Gui.frmQte.optTopLevel.Value(1)
				Gui.frmQte.optComponent.Value(0)
				Gui.frmQte.optTopLevel.Enabled(True)
				Gui.frmQte.optComponent.Enabled(True)
			F.Intrinsic.Control.ElseIf(V.DataTable.dtPart(V.Local.sSelect.Long).Code_Bom!FieldValTrim,=,"C")
				Gui.frmQte.optTopLevel.Value(0)
				Gui.frmQte.optComponent.Value(1)
				Gui.frmQte.optTopLevel.Enabled(True)
				Gui.frmQte.optComponent.Enabled(True)
			F.Intrinsic.Control.Else
				Gui.frmQte.optTopLevel.Value(0)
				Gui.frmQte.optComponent.Value(0)
				Gui.frmQte.optTopLevel.Enabled(False)
				Gui.frmQte.optComponent.Enabled(False)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Date.DateAddWorkdays(V.Ambient.Date,V.DataTable.dtPart(V.Local.sSelect.Long).Time_Material_Lead!FieldVal,62,V.Local.dRet)
			Gui.frmQte.dtpDueDate.Value(V.Local.dRet)
			Gui.frmQte.txtQtyOnHand.Text(V.DataTable.dtPart(V.Local.sSelect.Long).Qty_OnHand!FieldVal)
			Gui.frmQte.txtQtyReq.Text(V.DataTable.dtPart(V.Local.sSelect.Long).Qty_Required!FieldVal)
			Gui.frmQte.txtProdLine.Text(V.DataTable.dtPart(V.Local.sSelect.Long).Product_Line!FieldVal)
			Gui.frmQte.txtUM.Text(V.DataTable.dtPart(V.Local.sSelect.Long).UM!FieldValTrim)
			F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}';",V.DataTable.dtPart(V.Local.sSelect.Long).Part!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.sRet2)
			F.Intrinsic.Control.If(V.Ambient.ExecuteAndReturnEOF)
				Gui.frmQte.txtRouter.Text("N")
			F.Intrinsic.Control.Else
				Gui.frmQte.txtRouter.Text("Y")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cboPart_LostFocus.End

Program.Sub.cboLoc_LostFocus.Start
Program.Sub.cboLoc_LostFocus.End

Program.Sub.cmdComments_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'Pull and load comments
	F.Intrinsic.Control.CallSub(LoadDtComments)
	Gui.frmComments..Show

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdComments_Click.End

Program.Sub.LoadDtComments.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.sSQL.Declare
	
	F.Intrinsic.Control.If(V.DataTable.dtComments.Exists)
		F.Data.DataTable.Close("dtComments")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select * From GAB_4812_BOM_CMNTS Where RanKey = '{0}' Order By GRPID;",V.Global.iRanKey,V.Local.sSQL)
	F.Data.DataTable.CreateFromSQL("dtComments","con",V.Local.sSQL,True)
	
	Gui.frmComments.GsGCComments.AddGridviewFromDatatable("gvComments","dtComments")
	Gui.frmComments.GsGCComments.SuspendLayout()
	Gui.frmComments.GsGCComments.SetGridViewProperty("gvComments","MultiSelect",True)
	Gui.frmComments.GsGCComments.SetGridViewProperty("gvComments","Editable",False)
	Gui.frmComments.GsGCComments.SetGridViewProperty("gvComments","ReadOnly",True)
	Gui.frmComments.GsGCComments.SetGridViewProperty("gvComments","AllowSort",True)
	Gui.frmComments.GsGCComments.SetGridViewProperty("gvComments","AllowFilter",True)
	Gui.frmComments.GsGCComments.SetGridViewProperty("gvComments","OptionsDetailShowDetailTabs",False)
	Gui.frmComments.GsGCComments.SetGridViewProperty("gvComments","OptionsViewShowGroupPanel",False)
		
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","CMID","Visible",False)
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","RANKEY","Visible",False)
				
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","GRPID","Caption","Group")
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","COMMENTS","Caption","Comments")
				
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","GRPID","MinWidth","40")
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","COMMENTS","MinWidth","500")
				
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","GRPID","HeaderFontBold",True)
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","COMMENTS","HeaderFontBold",True)
			
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","GRPID","HeaderHAlignment","Center")
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","COMMENTS","HeaderHAlignment","Center")
				
	Gui.frmComments.GsGCComments.SetColumnProperty("gvComments","GRPID","CellHAlignment","Center")
		
	Gui.frmComments.GsGCComments.ResumeLayout()
	Gui.frmComments.GsGCComments.MainView("gvComments")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDtComments.End

Program.Sub.frmComments_UnLoad.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmComments..Visible(False)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmComments_UnLoad.End

Program.Sub.frmComments_Resize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.frmComments_Resize.End

Program.Sub.GsGCComments_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	Gui.frmComments.txtGroup.Text(V.DataTable.dtComments(V.Args.RowIndex).GRPID!FieldVal)
	Gui.frmComments.txtComments.Text(V.DataTable.dtComments(V.Args.RowIndex).COMMENTS!FieldVal)
	V.Global.iRowIndex.Set(V.Args.RowIndex)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCComments_RowCellClick.End

Program.Sub.cmdNew_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	V.Local.iGrpID.Declare
	
	F.Data.DataTable.Compute("dtComments","Max(GRPID)","",V.Local.iGrpID)
	F.Intrinsic.Math.Add(V.Local.iGrpID,1,V.Local.iGrpID)
	Gui.frmComments.txtGroup.Text(V.Local.iGrpID)
	Gui.frmComments.txtComments.Text("")
	Gui.frmComments.txtComments.SetFocus
	V.Global.iRowIndex.Set(-1)

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdNew_Click.End

Program.Sub.cmdSave_ClickCmnts.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare

	F.Intrinsic.Control.If(V.Screen.frmComments!txtGroup.Text,<>,"")
		F.Intrinsic.Control.If(V.Global.iRowIndex,=,-1)
			F.Data.DataTable.AddRow("dtComments","CMID",0,"GRPID",V.Screen.frmComments!txtGroup.Text,"RANKEY",V.Global.iRanKey,"COMMENTS",V.Screen.frmComments!txtComments.Text)
		F.Intrinsic.Control.Else
			F.Data.DataTable.SetValue("dtComments",V.Global.iRowIndex,"COMMENTS",V.Screen.frmComments!txtComments.Text)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SaveToDB("dtComments","con","GAB_4812_BOM_CMNTS","CMID")
	F.Intrinsic.Control.CallSub(LoadDtComments)
	
	Gui.frmComments.txtGroup.Text("")
	Gui.frmComments.txtComments.Text("")

	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdSave_ClickCmnts.End